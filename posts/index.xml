<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on Under The Ginkgo</title>
        <link>https://example.com/posts/</link>
        <description>Recent content in Posts on Under The Ginkgo</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <lastBuildDate>Fri, 18 Mar 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://example.com/posts/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Password Cracking</title>
        <link>https://example.com/posts/password_cracking/</link>
        <pubDate>Fri, 18 Mar 2022 00:00:00 +0000</pubDate>
        
        <guid>https://example.com/posts/password_cracking/</guid>
        <description>&lt;h2 id=&#34;password-cracking&#34;&gt;Password Cracking&lt;/h2&gt;
&lt;h3 id=&#34;case-study-adobe-password-leak&#34;&gt;Case Study: Adobe Password Leak&lt;/h3&gt;
&lt;p&gt;If you are familiar with how online service store users&amp;rsquo;s password, let me ask you:&lt;/p&gt;
&lt;p&gt;How Should You Do?&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_09-43-18_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;p&gt;Yes, we will use hash algorithm, salt and store the hashed password and salt, which actively avoid the exposion of plaintext password and brute force.&lt;/p&gt;
&lt;p&gt;But how Adobe Did It?&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_09-46-25_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;p&gt;What are the consequences?&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;If you get the master key, literally you own all &amp;ldquo;encrypted passwords&amp;rdquo;&lt;/li&gt;
&lt;li&gt;If two users choose same password, their encrypted ciphertext are same, consequently, frequently analysis would help hacker to find out the details of encryption process.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;For more details, please refer to this article: &lt;a class=&#34;link&#34; href=&#34;https://nakedsecurity.sophos.com/2013/11/04/anatomy-of-a-password-disaster-adobes-giant-sized-cryptographic-blunder/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Anatomy of a password disaster – Adobe’s giant-sized cryptographic blunder&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;cryptanalysis-basics&#34;&gt;Cryptanalysis basics&lt;/h3&gt;
&lt;dl&gt;
&lt;dt&gt;Cryptanalysis&lt;/dt&gt;
&lt;dd&gt;The study of techniques to reveal what cryptography is attempting to hide or protect.&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;In other words, break the cryptographyic algorithms without knowing the key.&lt;/p&gt;
&lt;p&gt;Cryptanalysis are based on:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The nature of the cryptographyic aglorithm&lt;/li&gt;
&lt;li&gt;the key&lt;/li&gt;
&lt;li&gt;some knowledge on the text, such as language(common words), format or encoding (script, image alway begin with some same pattern),&lt;/li&gt;
&lt;li&gt;a section with both plaintext and encrypted text&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;brute-force-attacks&#34;&gt;Brute-force attacks&lt;/h4&gt;
&lt;dl&gt;
&lt;dt&gt;Brute-force attack&lt;/dt&gt;
&lt;dd&gt;Aim to decrypt an encrypted text by exhaustively traing all possible secret keys until you obtain a meaningful plaintext&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;On average, you need to try at least half of all the posssbile keys to be successful&lt;/p&gt;
&lt;p&gt;For example, to brute force a 4-digit password, the number of possibilities is 10^4 = 10000, therefore, on average, a brute-force attack in this scenario will succeed after 5000 attempts. If 1 attempt cost 1s, it needs at least 1h24min to finish this work.&lt;/p&gt;
&lt;h4 id=&#34;dictionary-attacks&#34;&gt;Dictionary attacks&lt;/h4&gt;
&lt;p&gt;4-digit password needs one hour and half? Forget about it, let&amp;rsquo;s to try something not so naive.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s first define the term &amp;ldquo;password&amp;rdquo; as a user-defined encrypted secret key.&lt;/p&gt;
&lt;dl&gt;
&lt;dt&gt;Passowrd dictionary attacks&lt;/dt&gt;
&lt;dd&gt;Use a &amp;ldquo;dictionary&amp;rdquo; of possbile words (based on an attacker-defined alphabet) to make exploitation attempts, including English words, user&amp;rsquo;s private information and common passwords.&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;Common dictionaries for attacks include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Words and meaningful fragments of words combination for a certain language&lt;/li&gt;
&lt;li&gt;Personal information (eg, obtained from OSINT or social engineering)&lt;/li&gt;
&lt;li&gt;Lists of names, locations, dates, companies, etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Therefore, if the attackers use dictionary attack, the password length does not provide too much help on password robustness.&lt;/p&gt;
&lt;h4 id=&#34;password-robustness&#34;&gt;Password robustness&lt;/h4&gt;
&lt;p&gt;There are four main elements to determine the security of a password&lt;/p&gt;
&lt;dl&gt;
&lt;dt&gt;Number of symbols in the password&lt;/dt&gt;
&lt;dd&gt;As we mentioned before, 4-digit locker would require on average 10^4/2 seconds, or almost 1.5 hours to bruite force, the longer password, the longer time to brute force.&lt;/dd&gt;
&lt;dt&gt;Number of possibilities for each position&lt;/dt&gt;
&lt;dd&gt;We continue use previous example, if we expand the types of symbols to alphabet and number, the possibilities expand to 36*36*36 for brute force, which requires much more time than 1.5 horus&lt;/dd&gt;
&lt;dt&gt;Time required for each attempt&lt;/dt&gt;
&lt;dd&gt;Based on my experience, some online service will delay the login attempt to expand the time of brute force, which may also help to defend the attack like DDoS.&lt;/dd&gt;
&lt;dt&gt;Are there easier alternatives&lt;/dt&gt;
&lt;dd&gt;Remember we metioned in &lt;em&gt;Social Engineering&lt;/em&gt;: &amp;ldquo;The easiest way to get the information you want is always by asking the victims themselves&amp;rdquo;? There are always more than one way to get the anser of a question, so does cryptanalysis, you can even physically break the lock:)
Some other common alternatives:
&lt;ul&gt;
&lt;li&gt;finding write-down notes in officers&lt;/li&gt;
&lt;li&gt;shoulder-surfing, ie looking over someone&amp;rsquo;s should when they&amp;rsquo;re typing their passwords&lt;/li&gt;
&lt;li&gt;physical break-in&lt;/li&gt;
&lt;li&gt;physically stealing passwords lists or logbooks&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;h3 id=&#34;cryptographic-hash-functions&#34;&gt;Cryptographic hash functions&lt;/h3&gt;
&lt;dl&gt;
&lt;dt&gt;Hash function&lt;/dt&gt;
&lt;dd&gt;A function that maps input data of &lt;code&gt;arbitrary size&lt;/code&gt; to &lt;code&gt;fixed-size&lt;/code&gt; outoput values called hashes.&lt;/dd&gt;
&lt;dt&gt;Crytographic hash functions (CHF)&lt;/dt&gt;
&lt;dd&gt;are hash functions more suitable for information security applications which contains ideal following properties:
&lt;ol&gt;
&lt;li&gt;deterministic: given message M, its hash H(M) is always the same&lt;/li&gt;
&lt;li&gt;quick to compute&lt;/li&gt;
&lt;li&gt;unfeasible to generate message M that has a specific hash value H (hard to find alternative message M&#39;)&lt;/li&gt;
&lt;li&gt;unfeasible to find messages M1 and M2 such that H(M1) = H(M2) (hard to find a collision)&lt;/li&gt;
&lt;li&gt;avalanche effect: a small change in message M leads to siginificant change to the hash value.&lt;/li&gt;
&lt;/ol&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;Usage of CHF includes MACs (Message Authentication Codes), digital signatures and authentications.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s use an example of CHF&lt;/p&gt;
&lt;p&gt;Left hand column is the input, after crypotographic hash function, we get the output, we called &lt;code&gt;Digest&lt;/code&gt; here.&lt;/p&gt;
&lt;p&gt;We can observe that, a single character change of input text, the digest would be very different from previous one.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_14-44-36_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;p&gt;As you can easily to guess, there are many problems and attacks which threat the CHF:&lt;/p&gt;
&lt;h4 id=&#34;the-birthday-problem--or-the-birthday-paradox&#34;&gt;The birthday problem (or the birthday paradox)&lt;/h4&gt;
&lt;p&gt;Let me ask you a classic question, how many people you need in a single room, which makes the probability that at least two person share a birthday to be 50%?&lt;/p&gt;
&lt;p&gt;You need only 23 people to raise probability to 50 per cent.&lt;/p&gt;
&lt;p&gt;Prove:
The goal is to compute P(A), the probability that at least two people in the room have same birthday.
However, it is simpler to caculate the reverse one, P(A&amp;rsquo;), the probability that no two people in the room have the same birthday.
To calculate P(A&amp;rsquo;), the event is that &lt;code&gt;person 2&lt;/code&gt; does not have the same birthday as &lt;code&gt;person 1&lt;/code&gt;, and that persona 3 doest not have the same birthday as either person 1 or person 2, and so on, and finally that person 23 does not have the same birthday as any of persons 1 thurough 22. Let&amp;rsquo;s number this event as Event1 to Event 23&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s calculate the product of the probability of these events:&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_15-31-52_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;p&gt;Evaluating equation (2) gives P(A&amp;rsquo;) ≈ 0.492703&lt;/p&gt;
&lt;p&gt;Therefore, P(A) ≈ 1 − 0.492703 = 0.507297 (50.7297%).&lt;/p&gt;
&lt;p&gt;Also, according to the &lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Pigeonhole%5Fprinciple&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;pigenhole principle&lt;/a&gt;, the probability reaches 100 per cent when at least 367 people are present since there are only 366 possible birthdays.&lt;/p&gt;
&lt;p&gt;Based on above knowledge, we can understand that birthday attack is based on higher likelihood of collisions found between &lt;strong&gt;random attack&lt;/strong&gt; and &lt;strong&gt;fixed degree of permutations&lt;/strong&gt;.&lt;/p&gt;
&lt;h4 id=&#34;collision-attack&#34;&gt;Collision attack&lt;/h4&gt;
&lt;p&gt;The collision attack aims to identify two inputs that generate the same hash.&lt;/p&gt;
&lt;p&gt;More formally, we assume user has password &lt;strong&gt;P&lt;/strong&gt; with hash &lt;strong&gt;H(P)&lt;/strong&gt;, an attacker may find another string Q, such that H(P) = H(Q)&lt;/p&gt;
&lt;p&gt;This is why we need CHF to have the property to make it feasible to find the collision.&lt;/p&gt;
&lt;h4 id=&#34;preimage-attack&#34;&gt;Preimage attack&lt;/h4&gt;
&lt;p&gt;The preimage attack aims to find a message that has a specific hash value&lt;/p&gt;
&lt;p&gt;More formally, an adversary &amp;rsquo;tweaks&amp;rsquo; an input message M&amp;rsquo; until H(M&amp;rsquo;)=H(M)&lt;/p&gt;
&lt;p&gt;This attack will put huge harm to the security property: Integrity, because if this kind of tweak success, we can not trust anything, if even it has been hashed.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s see an example:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Message M: Give Mr John Smith a salary increase of £1,000.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This message will be digitally signed as a contract by CHF H.&lt;/p&gt;
&lt;p&gt;But the attacker finds some alternatives of messages which change their meaning of the input message, but get the same output digest as H(M)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Message M’: Award Mr Smith a raise of £2,000&lt;/li&gt;
&lt;li&gt;Message M&amp;rsquo;&amp;rsquo;: Present John Smith a bonus of £3,000&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Same signed hash value, different meaning, how powerful it is&amp;hellip;&lt;/p&gt;
&lt;h3 id=&#34;md5-collision-exercise&#34;&gt;MD5 collision exercise&lt;/h3&gt;
&lt;p&gt;When we download some files/software, many of them will provide md5 authentication, to authenticate that the integrity of the software, however, here is a &lt;a class=&#34;link&#34; href=&#34;https://www.mscs.dal.ca/~selinger/md5collision/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;exercise&lt;/a&gt; that shows MD5 can not be trusted anymore.&lt;/p&gt;
&lt;p&gt;Please review the details, I will just post something interesting here:&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s see two programs like this:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Program 1: if (data1 == data1) then { good_program } else { evil_program }
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Program 2: if (data2 == data1) then { good_program } else { evil_program }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;The only difference between these two statements is the variable to compare, however, it has been proved by Chinese researchers that we can only change some data in the input source files, but get the same MD5 hash value, which announce the death of MD5.&lt;/p&gt;
&lt;h3 id=&#34;rainbow-table-attacks&#34;&gt;Rainbow table attacks&lt;/h3&gt;
&lt;p&gt;In this section, we will see a smarter variant of dctionary attack to do the brute froce, it called &lt;strong&gt;precomputed dictionary attack&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;In this attack, we will precompute a list of hashes of dictionary words, and store in a table, which you can always easily to map the hashed text and plaintext password. If &amp;ldquo;hash-chain&amp;rdquo; functions are used to store the pre-computed hashes(to reduce the storage space), then the table is called a &lt;code&gt;rainbow table&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s use an example to introduce the terms and processes in a Rainbow Table usage.&lt;/p&gt;
&lt;p&gt;The letter H denotes a hash function.&lt;/p&gt;
&lt;p&gt;The letters R_i denote different reduction fucntions, which are aim to store more plaintext-hashed_text chains in the table. The number and sequences of reduction functions are same in each row.&lt;/p&gt;
&lt;p&gt;We only store only two columns of data in a system: 1. The first column (in green) and the last (in yellow).&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_16-33-39_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;h4 id=&#34;how-we-utilise-the-rainbow-table-the-plaintext-of-a-given-hashed-text&#34;&gt;How we utilise the rainbow table the plaintext of a given hashed text?&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Step 0
We find the hashed text &amp;ldquo;re3xes&amp;rdquo; in /etc/shadow directory of the victim, we want the plaintext of the password, and have a rainbow table which contains two columns (green and yellow).&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_16-36-34_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Step 1
We use the reduction function R3 on &amp;ldquo;re3xes&amp;rdquo; (start from last reduction function) and see if the result &amp;ldquo;rambo&amp;rdquo; is in the last column of the rainbow table. In this example it is not.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_16-39-37_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Step 2
Next, try two rounds of reduction function, use reductions R2 and R3 and obtain &amp;ldquo;linux23&amp;rdquo; as the result.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_16-50-07_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Step 3
Find the match&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_16-50-29_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Step 4
Start with matched plaintext column &amp;ldquo;passwd&amp;rdquo; and do the reductions to reach plaintext which will hashed to given hashed text &amp;ldquo;re3xes&amp;rdquo;.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_16-51-59_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;dl&gt;
&lt;dt&gt;Summary&lt;/dt&gt;
&lt;dd&gt;We assume that the given hashed text are contained in the chains of a row in the rainbow table, and use a sequence of reduction functions and hash function to see if it could reach the last column. If there is match, then we could locate the row of first (green) column and begin to reproduce the chains and get the plaintext.
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_16-43-11_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;/dd&gt;
&lt;/dl&gt;
&lt;h4 id=&#34;salt&#34;&gt;Salt&lt;/h4&gt;
&lt;p&gt;Remeber me metioned a term in first section: Salt? Rainbow table attacks and precomputed dictionary attacks can be thwarted via the use of salt. The reason is very simple, even if you can use precomputed table based on some common use dictionaries, but you can predict what&amp;rsquo;s the result used.&lt;/p&gt;
&lt;p&gt;Here are the most common mistakes in applying salt:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Using short salts:
if the salt is too short, the attacker may predict or brute-force pre-computed dictionaries with known salts.&lt;/li&gt;
&lt;li&gt;Reusing salts:
if you reuse the salt for multiple accounts, the attacker will easil find out that the plaintxt passwords were the same, and use side-channel information (eg, password hints) to corrupt multiple accounts at once.
Moreover, if the attacker randomly predicted the correct salt while computing a precomputed dicionary, then all the passwords would be compromised at once.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Finally it is important to note that using a ‘salt’ is not robust enough to thwart dictionary attacks, but only the pre-computation.&lt;/p&gt;
&lt;h3 id=&#34;countermeasures-and-best-practices&#34;&gt;Countermeasures and best practices&lt;/h3&gt;
&lt;h4 id=&#34;weak-passwords&#34;&gt;Weak passwords&lt;/h4&gt;
&lt;dl&gt;
&lt;dt&gt;Default passwords&lt;/dt&gt;
&lt;dd&gt;Default provided by system vendor which should be changed at installation time
&lt;ul&gt;
&lt;li&gt;password&lt;/li&gt;
&lt;li&gt;default&lt;/li&gt;
&lt;li&gt;admin&lt;/li&gt;
&lt;li&gt;guest&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt;Dictionary words&lt;/dt&gt;
&lt;dd&gt;Including non-English dictionaries:
&lt;ul&gt;
&lt;li&gt;chameleon&lt;/li&gt;
&lt;li&gt;RedSox&lt;/li&gt;
&lt;li&gt;sandbags&lt;/li&gt;
&lt;li&gt;bunnyhop&lt;/li&gt;
&lt;li&gt;IntenseCrabtree&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt;Words with numbers appended&lt;/dt&gt;
&lt;dd&gt;These can be easily tested automatically by attackers with little lost time.
&lt;ul&gt;
&lt;li&gt;password1&lt;/li&gt;
&lt;li&gt;deer2000&lt;/li&gt;
&lt;li&gt;john1234&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt;Words with simple obfuscations&lt;/dt&gt;
&lt;dd&gt;Still, it can be tested automatically with little additional effort
&lt;ul&gt;
&lt;li&gt;p@ssw0rd&lt;/li&gt;
&lt;li&gt;l33th4x0r&lt;/li&gt;
&lt;li&gt;g0ldf1sh&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt;Doubled words&lt;/dt&gt;
&lt;dd&gt;&lt;ul&gt;
&lt;li&gt;crabcrab&lt;/li&gt;
&lt;li&gt;stopstop&lt;/li&gt;
&lt;li&gt;treetree&lt;/li&gt;
&lt;li&gt;passpass.&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt;Common sequences from a keyboard row&lt;/dt&gt;
&lt;dd&gt;&lt;ul&gt;
&lt;li&gt;qwerty&lt;/li&gt;
&lt;li&gt;123456&lt;/li&gt;
&lt;li&gt;asdfgh&lt;/li&gt;
&lt;li&gt;fred.&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt;Numeric sequences based on well known numbers such as&lt;/dt&gt;
&lt;dd&gt;&lt;ul&gt;
&lt;li&gt;911 (9-1-1, 9/11)&lt;/li&gt;
&lt;li&gt;314159&amp;hellip; (pi)&lt;/li&gt;
&lt;li&gt;27182&amp;hellip; (e)&lt;/li&gt;
&lt;li&gt;112 (1-1-2).&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt;Identifiers&lt;/dt&gt;
&lt;dd&gt;&lt;ul&gt;
&lt;li&gt;jsmith123&lt;/li&gt;
&lt;li&gt;1/1/1970&lt;/li&gt;
&lt;li&gt;555–1234&lt;/li&gt;
&lt;li&gt;one&amp;rsquo;s username.&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt;Weak passwords in non-English languages&lt;/dt&gt;
&lt;dd&gt;&lt;ul&gt;
&lt;li&gt;contraseña (Spanish)&lt;/li&gt;
&lt;li&gt;ji32k7au4a83 (encoding from Chinese).&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt;Anything personally related to an individual&lt;/dt&gt;
&lt;dd&gt;All these can be easily tested automatically after a simple investigation of a person&amp;rsquo;s details, eg through social engineering.
&lt;ul&gt;
&lt;li&gt;license plate number&lt;/li&gt;
&lt;li&gt;social security number&lt;/li&gt;
&lt;li&gt;current or past telephone numbers&lt;/li&gt;
&lt;li&gt;student ID number&lt;/li&gt;
&lt;li&gt;current address&lt;/li&gt;
&lt;li&gt;previous addresses&lt;/li&gt;
&lt;li&gt;birthday&lt;/li&gt;
&lt;li&gt;sports team&lt;/li&gt;
&lt;li&gt;relative&amp;rsquo;s or pet&amp;rsquo;s names, nicknames, birthdays, initials, etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt;Dates&lt;/dt&gt;
&lt;dd&gt;Dates follow a pattern and make passwords weak.&lt;/dd&gt;
&lt;dt&gt;Common passwords from previous leaks&lt;/dt&gt;
&lt;dd&gt;For example, the top 10 most common passwords in a &lt;a class=&#34;link&#34; href=&#34;https://edition.cnn.com/2019/04/22/uk/most-common-passwords-scli-gbr-intl/index.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CNN article&lt;/a&gt;:
&lt;ul&gt;
&lt;li&gt;123456&lt;/li&gt;
&lt;li&gt;123456789&lt;/li&gt;
&lt;li&gt;qwerty&lt;/li&gt;
&lt;li&gt;password&lt;/li&gt;
&lt;li&gt;111111&lt;/li&gt;
&lt;li&gt;12345678&lt;/li&gt;
&lt;li&gt;abc123&lt;/li&gt;
&lt;li&gt;1234567&lt;/li&gt;
&lt;li&gt;password1&lt;/li&gt;
&lt;li&gt;
&lt;ol start=&#34;12345&#34;&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;h4 id=&#34;side-channel-attacks&#34;&gt;Side-channel attacks&lt;/h4&gt;
&lt;p&gt;As the name suggest, rather than exploit the weakness of the algorithm itself (eg. cryptanalysis and software bugs), a side-channel attack relies on information gained from the implementation of a computer system.&lt;/p&gt;
&lt;p&gt;For example:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;timing information (eg, implement the encryption, hashing)&lt;/li&gt;
&lt;li&gt;power comsuption&lt;/li&gt;
&lt;li&gt;electromagnetic leaks&lt;/li&gt;
&lt;li&gt;sound&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If you are familar with SQL injection, the blind injection is also a side-channel attacks.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s look at the details of a &lt;code&gt;timeing attack&lt;/code&gt;:
By analyse time taken by the cryptographic algorithm implemenetation operation, the attacker is able to reverse enginner the input.&lt;/p&gt;
&lt;p&gt;In 2003, &lt;a class=&#34;link&#34; href=&#34;https://id.elsevier.com/as/authorization.oauth2?platSite=SD%2Fscience&amp;amp;scope=openid%20email%20profile%20els%5Fauth%5Finfo%20els%5Fidp%5Finfo%20els%5Fidp%5Fanalytics%5Fattrs%20els%5Fsa%5Fdiscover%20urn%3Acom%3Aelsevier%3Aidp%3Apolicy%3Aproduct%3Ainst%5Fassoc&amp;amp;response%5Ftype=code&amp;amp;redirect%5Furi=https%3A%2F%2Fwww.sciencedirect.com%2Fuser%2Fidentity%2Flanding&amp;amp;authType=SINGLE%5FSIGN%5FIN&amp;amp;prompt=login&amp;amp;client%5Fid=SDFE-v3&amp;amp;state=retryCounter%3D0%26csrfToken%3D8db72d04-1503-4c61-852a-86ec787771b8%26idpPolicy%3Durn%253Acom%253Aelsevier%253Aidp%253Apolicy%253Aproduct%253Ainst%5Fassoc%26returnUrl%3D%252Fscience%252Farticle%252Fpii%252FS1389128605000125%253Fvia%25253Dihub%26prompt%3Dlogin%26cid%3Darp-7f672742-0676-47c6-9ce3-f01d2dc6f238&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Boneh and Brumley&lt;/a&gt; publsihed a practical network-based timing attack on SSL-enabled web server, the server key was recovered in a matter of hours using this method.&lt;/p&gt;
&lt;h4 id=&#34;good-practice-around-passwords&#34;&gt;Good practice around passwords&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Do not reuse passwords
&lt;ul&gt;
&lt;li&gt;Browser&lt;/li&gt;
&lt;li&gt;KeePassX&lt;/li&gt;
&lt;li&gt;Local&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Use password managers&lt;/li&gt;
&lt;li&gt;Use Two-Factor Authentication (2FA)&lt;/li&gt;
&lt;/ul&gt;</description>
        </item>
        <item>
        <title>Pwn The Box WEB-Easy</title>
        <link>https://example.com/posts/pwnthebox_web_easy/</link>
        <pubDate>Fri, 18 Mar 2022 00:00:00 +0000</pubDate>
        
        <guid>https://example.com/posts/pwnthebox_web_easy/</guid>
        <description>&lt;h2 id=&#34;exec1&#34;&gt;exec1&lt;/h2&gt;
&lt;p&gt;命令行执行
先读源码，&lt;/p&gt;
&lt;p&gt;首先，脚本用str_replace替换了所有特殊字符，由于是单独字符的替换，没有办法利用双写绕过，接着考虑下面命令行中如果执行额外的命令
通过%0A换行实现新的命令执行
?ip=1%0Als
得到&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-18_11-19-50_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;p&gt;进而获取文件内容&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-18_11-20-29_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// Get input
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ip&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// var_dump($target);
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;trim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// var_dump($target);
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// Set blacklist
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;$substitutions&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;amp;&amp;#39;&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;|&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;$&amp;#39;&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;(&amp;#39;&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;)&amp;#39;&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;`&amp;#39;&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;||&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// Remove any of the charactars in the array (blacklist).
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;str_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;array_keys&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$substitutions&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$substitutions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// var_dump($target);
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// Determine OS and execute the ping command.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;stristr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;php_uname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;s&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Windows NT&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// Windows
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nv&#34;&gt;$cmd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;shell_exec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ping  &amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// *nix
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;nv&#34;&gt;$cmd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;shell_exec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ping  -c 1 &amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// Feedback for the end user
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt;  &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;pre&amp;gt;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$cmd&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;lt;/pre&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;虽然这里不能使用，但是这里复习一下Windows和*nix的管道符号&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Windows系例支持的管道符如下所示。
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;“|”：直接执行后面的语句。例如：ping 127.0.0.1|whoami。
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;“||”：如果前面执行的语句执行出错，则执行后面的语句，前面的语句只能为假。例如：ping 2||whoami。
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;“&amp;amp;”：如果前面的语句为假则直接执行后面的语句，前面的语句可真可假。例如：ping 127.0.0.1&amp;amp;whoami。
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;“&amp;amp;&amp;amp;”：如果前面的语句为假则直接出错，也不执行后面的语句，前面的语句只能为真。例如：ping 127.0.0.1&amp;amp;&amp;amp;whoami。
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Linux系统支持的管道符如下所示。
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;“;”：执行完前面的语句再执行后面的。例如：ping 127.0.0.1;whoami。
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;“|”：显示后面语句的执行结果。例如：ping 127.0.0.1|whoami。
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;“||”：当前面的语句执行出错时，执行后面的语句。例如：ping 1||whoami。
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;“&amp;amp;”：如果前面的语句为假则直接执行后面的语句，前面的语句可真可假。例如：ping 127.0.0.1&amp;amp;whoami。
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;“&amp;amp;&amp;amp;”：如果前面的语句为假则直接出错，也不执行后面的，前面的语句只能为真。例如：ping 127.0.0.1&amp;amp;&amp;amp;whoami。
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;hackergame2019-签到题&#34;&gt;hackergame2019-签到题&lt;/h2&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-18_11-43-43_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;p&gt;根据提示查看前一年的签到题的&lt;a class=&#34;link&#34; href=&#34;https://github.com/ustclug/hackergame2018-writeups/blob/master/official/qiandao/README.md#%E8%A7%A3%E6%B3%95%E4%BA%8C%E5%AE%A1%E6%9F%A5%E5%85%83%E7%B4%A0&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;writeup&lt;/a&gt;，猜测token应该是hackergame2019，接下来就是如何提交token了&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-18_11-47-03_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;h2 id=&#34;管理员本地访问&#34;&gt;管理员本地访问&lt;/h2&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_17-28-42_screenshot.png&#34; width=&#34;500px&#34;/&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_17-30-28_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;p&gt;本题考查Burp使用以及http header的理解，加上client-ip: 127.0.0.1即可在“本地”访问得到flag&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_17-36-12_screenshot.png&#34; width=&#34;1000px&#34;/&gt;
&lt;/figure&gt;

&lt;h2 id=&#34;下载下载&#34;&gt;下载下载&lt;/h2&gt;
&lt;p&gt;先尝试下载flag.txt文件是空的&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_17-42-12_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;p&gt;根据源代码提示，查询flag.php文件
?file=flag.php&lt;/p&gt;
&lt;p&gt;得到解密方法，放在本地服务器运行后得到flag&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Content-Type: text/html; charset=utf-8&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;//网页编码
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;encrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;md5&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nv&#34;&gt;$x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nv&#34;&gt;$len&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;strlen&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nv&#34;&gt;$l&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;strlen&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nv&#34;&gt;$x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nv&#34;&gt;$char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nv&#34;&gt;$x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nv&#34;&gt;$str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;chr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ord&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ord&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$char&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;base64_encode&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$str&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;decrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;md5&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nv&#34;&gt;$x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;base64_decode&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nv&#34;&gt;$len&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;strlen&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nv&#34;&gt;$l&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;strlen&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$l&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nv&#34;&gt;$x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nv&#34;&gt;$char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;substr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nv&#34;&gt;$x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ord&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;substr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ord&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;substr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nv&#34;&gt;$str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;chr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ord&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;substr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ord&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;substr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nv&#34;&gt;$str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;chr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ord&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;substr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ord&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;substr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Pwnthebox&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$flag&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;g9yk1pqdmqHa3qTJlqTFZbmShKmjaMHKzpJprg==&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;decrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;快速计算&#34;&gt;快速计算&lt;/h2&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-19_20-20-21_screenshot.png&#34; width=&#34;500px&#34;/&gt;
&lt;/figure&gt;

&lt;p&gt;尝试计算后输入结果，是真的需要短时间内得到结果，使用python来实现一个脚本，首先GET获取公示，继而计算后POST返回，最后得到返回的flag&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;re&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;https://1239-e39bb701-ed06-4211-90bc-cabd6f666121.do-not-trust.hacking.run&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# get the GET result&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;get_result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# use regular expression to find out the first result which end with pattern &amp;#34;&amp;lt;/p&amp;gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;re&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;findall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;\S*(?=&amp;lt;/p&amp;gt;)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;get_result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;post_result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;result&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post_result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;该网站已经被黑&#34;&gt;该网站已经被黑&lt;/h2&gt;
&lt;p&gt;在主页没有发现有用的信息
那么直接用dirmap直接扫目录&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-20_21-13-35_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;h2 id=&#34;pwnthebox&#34;&gt;PwnTheBox&lt;/h2&gt;
&lt;p&gt;查看源代码，获得提示flag在header里面&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-18_11-58-54_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;p&gt;放进Burp里看一下response，获得Flag&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-18_12-02-54_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;h2 id=&#34;百度网盘分享链接&#34;&gt;百度网盘分享链接&lt;/h2&gt;
&lt;p&gt;题目提示类型为口令爆破，猜测应该是4位数字（不然也太多了）&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-18_12-05-15_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;p&gt;放到Burp里用Intruder扫描一下&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;h2 id=&#34;get&#34;&gt;Get&lt;/h2&gt;
&lt;p&gt;阅读给出的源码，只要给一个GET参数，并且值为“flag”即可&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-18_12-20-54_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;p&gt;?what=flag&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-18_12-21-56_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;h2 id=&#34;post&#34;&gt;Post&lt;/h2&gt;
&lt;p&gt;和上一题Get，类似，我们用hackbar，curl，burp，postman加上post参数的值就可以了&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-18_12-23-37_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-18_12-24-08_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;h2 id=&#34;php是世界上最好的语言&#34;&gt;php是世界上最好的语言&lt;/h2&gt;
&lt;p&gt;阅读源码，需要满足几个条件，参数$a,$b的sha1加密后密文相等，key为json格式的值，并且该json数据中的一个键叫做“key”，值和参数$key相等&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;show_source&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;no&#34;&gt;__FILE__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;include_once&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;flag.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//前端攻城狮跑路了，不过PHP是最好的语言
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nv&#34;&gt;$b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nv&#34;&gt;$good&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nv&#34;&gt;$good&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;bypass&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$good&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;key&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])){&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nv&#34;&gt;$message&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;key&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$message&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;还差一点就拿到flag了&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;第一个条件很容易满足，直接让a=b即可
第二个条件，我们首先让这个值满足json格式{key:value},并且这个value等于$key,利用php的弱类型语言的性质，当数字与字符串进行比较时，字符串会转换成数字来进行比较，同时第一位不为数字时，会转换为0，因此我们将value设置为0，皆可得到flag&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-18_12-30-28_screenshot.png&#34; width=&#34;600px&#34;/&gt;
&lt;/figure&gt;</description>
        </item>
        <item>
        <title>Social Engineering</title>
        <link>https://example.com/posts/social_engineering/</link>
        <pubDate>Mon, 07 Mar 2022 00:00:00 +0000</pubDate>
        
        <guid>https://example.com/posts/social_engineering/</guid>
        <description>&lt;h2 id=&#34;social-engineering&#34;&gt;Social Engineering&lt;/h2&gt;
&lt;h3 id=&#34;strategies-and-principles&#34;&gt;Strategies and Principles&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;&amp;ldquo;The easiest way to get the information you want is always by asking the victims themselves:)&amp;rdquo;&lt;/em&gt;&lt;/p&gt;
&lt;dl&gt;
&lt;dt&gt;Definition: Social engineering&lt;/dt&gt;
&lt;dd&gt;Social engineering is the practice of manipulating people into revealing condifential or sensitive information about the organisation, or to perform certain actions, such as:
&lt;ul&gt;
&lt;li&gt;open an infected attachment via email&lt;/li&gt;
&lt;li&gt;click on a URL of a compromised webiste&lt;/li&gt;
&lt;li&gt;divulge information over the phone&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;Instead of utilising the vulnerabilities we have seen previously, social engineering relies on non-technical strategies to exploit the weaknesses of human psychology.&lt;/p&gt;
&lt;p&gt;It is very similar to some &amp;lsquo;marketing&amp;rsquo; purposes, which often involved &amp;lsquo;acting skills&amp;rsquo;, it requires social engineers to be confident with themsevles, and this sense of confidence will then naturally psychologically transfer also to the victim.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&amp;ldquo;Preteding not be afraid is as good as actually not being afraid. &amp;mdash;-David Letterman&amp;rdquo;&lt;/em&gt;&lt;/p&gt;
&lt;h4 id=&#34;key-principles&#34;&gt;Key principles&lt;/h4&gt;
&lt;p&gt;There are six key principles of influence that correspond to human behaviours heavily explooited by social engineering, identified by Professor Robert Cialdini, Regents&amp;rsquo; Professor Emeritus of Psychology and Marketing at Arizona State University, which originally from &amp;lsquo;marketing&amp;rsquo; purposes.&lt;/p&gt;
&lt;dl&gt;
&lt;dt&gt;Principle 1: Reciprocity&lt;/dt&gt;
&lt;dd&gt;People tend to return a favour. People usually do not trust free lunch, they would be more delight to take the benefit by doing a favour also to the attacker.&lt;/dd&gt;
&lt;dt&gt;Principle 2: Commitment and consistency&lt;/dt&gt;
&lt;dd&gt;People are willing to honor to the ideas and goals they committed which fits their self-image, e.g., particular charity activities,recyling, vegetarianism.
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://tactics.convertize.com/definitions/commitment-and-consistency&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;This a mental shortut we use to simplify our decision-making:&lt;/a&gt; we tend to simplify our decision making by using a post decision as reference for subsequent related choices. Consequently, we act in ways that are consistent with our intial action our thought, so that when we commit to something or someone, we stick to it.&lt;/p&gt;
&lt;/dd&gt;
&lt;dt&gt;Principle 3: Social proof/consensus&lt;/dt&gt;
&lt;dd&gt;People are tend to follow the crowd. For example, if attackers can convince the victim that their colleagues, friends or family already done that, the victims will be more willing to click the malicous link.&lt;/dd&gt;
&lt;dt&gt;Principle 4: Autority/intimidation&lt;/dt&gt;
&lt;dd&gt;People will tend to obey authority figures, even if they are asked to perform objectionable acts. The attacker can try to impersonate some senior members in their organisation or from government organisation, which the victim may not know personally.&lt;/dd&gt;
&lt;dt&gt;Principle 5: Linking/familarity&lt;/dt&gt;
&lt;dd&gt;People are more easily persuaded by other people whom they may familar with. The attackers could establish a link between them and victims by calling their first name, nickname, or throw some topics they may interesting (e.g., hobbies, sports).&lt;/dd&gt;
&lt;dt&gt;Pirnciple 6: Scarcity/urgency&lt;/dt&gt;
&lt;dd&gt;Perceived scarcity will generate demand, and it may indcue urgency in the victim, in this kind of scenario, victim could more easily to lose their judgement. Like a time-limited demand of work from the boss.&lt;/dd&gt;
&lt;/dl&gt;
&lt;h3 id=&#34;attack-phases&#34;&gt;Attack Phases&lt;/h3&gt;
&lt;h4 id=&#34;reconnaissance-phase&#34;&gt;Reconnaissance Phase&lt;/h4&gt;
&lt;dl&gt;
&lt;dt&gt;Aims to&lt;/dt&gt;
&lt;dd&gt;Appear credible and lure the victims into revealing sensitive information or perform dangerous actions&lt;/dd&gt;
&lt;dt&gt;Goals&lt;/dt&gt;
&lt;dd&gt;Learn about roles or key figures in the organisation, and find orangisation contact details and finally choosing victims.&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;Passive and Active reconnaissances can explore the tactics to identify hosts, networks, and users of interst, see more details in previoius post about reconnaissance.&lt;/p&gt;
&lt;h4 id=&#34;victim-appraoch-phase&#34;&gt;Victim Appraoch Phase&lt;/h4&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Goals?&lt;/p&gt;
&lt;p&gt;Establish a confidential relationship/feeling between attackers and the victim, by&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Exact victim&amp;rsquo;s positions in the company&lt;/li&gt;
&lt;li&gt;Use of nicknames known only in the company&lt;/li&gt;
&lt;li&gt;Praising the fole of the victim (e.g., knowing what they do)&lt;/li&gt;
&lt;li&gt;Belonging to some mailing list&lt;/li&gt;
&lt;li&gt;Personal interests of the victim&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Who?&lt;/p&gt;
&lt;p&gt;Usually, Not senior memebers,
but who closely tied to them (e.g., secretaries, collaborators)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Where?&lt;/p&gt;
&lt;p&gt;Phone, e-mail, social network (rarely done in person or face to face)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;How?&lt;/p&gt;
&lt;p&gt;Spear phishing
: Spear here is used to differentiating with traiditon phishing, which is crafted for &lt;!-- raw HTML omitted --&gt;a specific victim&lt;!-- raw HTML omitted --&gt;.
Send a targeted email to the vicitm, to lure them into clicking a link, opening an attachment, or revealing some sensitive information.&lt;/p&gt;
&lt;p&gt;Vishing
: Make a &lt;!-- raw HTML omitted --&gt;voice phone call&lt;!-- raw HTML omitted --&gt; to lure the victim into believing there is a demand for revealing sensitive information or performing attacker-desired actions.
The attacker could impersonate a manager/senior meember of the organisation, or pretending to be a colleagure in need, which use the principle of &amp;ldquo;Principle 4: Authority/intimidation&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;Smishing
: The attacker choose the most trusted communication method, and sending a text message to vicitims.&lt;/p&gt;
&lt;p&gt;Tailgating
: Instead of getting information from the victim in previous stragies, tailgating is aim to enter a restricted areas, it can be realised by following people with access, or pretending to be someone with access, for instance, a courier.&lt;/p&gt;
&lt;p&gt;Quid Pro Quo
: The attacker offers something in exchange for following his orders.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; For example, the attacker may call the victims and pretend to be a technician, then convince the vicitm to follow commands to grant him access or which lead to malware installation.

 Occssionally, the attacker may already have pre-install malware which slows down the PC, then try to contact the victim to provide some help.
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Countermeasures&lt;/p&gt;
&lt;p&gt;The core of social engineering is people, companies need to make regular security training for exmployees in all roles, to make them be aware of the potential strategies of attackers.&lt;/p&gt;
&lt;p&gt;Some strategies to check if you are being a victim of social engineering include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;asking for the correct spelling of their name&lt;/li&gt;
&lt;li&gt;asking for a number where you can return the call&lt;/li&gt;
&lt;li&gt;asking them why they need this information&lt;/li&gt;
&lt;li&gt;asking them who has authorised the request and let them know that you will verify the authorisation.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In general, if you suspect a social engineering attempt, report incidents immediately to the company’s security teams. Be skeptical and aware of risks. Look for emails with urgent requests of sensitive information or delicate actions, and typosquatting e-mail addresses.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</description>
        </item>
        <item>
        <title>Network Security Assessment</title>
        <link>https://example.com/posts/network_security_assessment/</link>
        <pubDate>Mon, 28 Feb 2022 00:00:00 +0000</pubDate>
        
        <guid>https://example.com/posts/network_security_assessment/</guid>
        <description>&lt;h2 id=&#34;network-security-assessment&#34;&gt;Network Security Assessment&lt;/h2&gt;
&lt;h3 id=&#34;phase-1-reconnaissance&#34;&gt;Phase 1: Reconnaissance&lt;/h3&gt;
&lt;p&gt;The initial phase of network security assessment is reconnaissance, in my understanding, this phase is used to gather the information of the target, including hosts, networks, users, services, etc. It is an essential preparation mission before you can really do something to the target.&lt;/p&gt;
&lt;p&gt;And the recoonaissance could be separated to passive or active.&lt;/p&gt;
&lt;h4 id=&#34;passive-reconnaissance&#34;&gt;Passive reconnaissance&lt;/h4&gt;
&lt;p&gt;In this case, &amp;ldquo;passive&amp;rdquo; means you do not directly interact or engage with target system. More specifically, you do not send any type of request to the target, thus the targets have no way of acknowledgement what you are doing.&lt;/p&gt;
&lt;p&gt;You should use all the tools to gather more information as possible&lt;/p&gt;
&lt;p&gt;Querying Search Engines and Websites
There are some typical data you can gather by querying search engines and wbsites&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Physical address of office locations&lt;/li&gt;
&lt;li&gt;Contact details, including email addresses and telephone numbers&lt;/li&gt;
&lt;li&gt;Details of internal email systems and routing&lt;/li&gt;
&lt;li&gt;DNS layout and naming conventions&lt;/li&gt;
&lt;li&gt;Files residing on publicly accessible servers&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Here are some powerful tools we can use&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol&gt;
&lt;li&gt;Google Advanced Search&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;It is very common for us to complain that Google returns some irrelevant results, but actually Google provides some powerful tools to enhance the search, it is the &amp;ldquo;Goolge Advanced search&amp;rdquo;, we can use its syntax to refine our search rules.&lt;/p&gt;
&lt;p&gt;For example, &amp;ldquo;inurl:program&amp;rdquo; results in all the websites or resources whose url or cotent contains the keyword &amp;ldquo;program&amp;rdquo;, you can even use &amp;ldquo;allinurl:program&amp;rdquo; to query all the url which contains &amp;ldquo;program&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;Another common example is, when you search &amp;ldquo;program moon&amp;rdquo;, the result will probabaly give you a lot of results with &amp;ldquo;program&amp;rdquo; while excluding the keyword &amp;ldquo;moon&amp;rdquo; because obviously there is less result contains moon. However, if you want to search the whole word which contains both &amp;ldquo;program moon&amp;rdquo;, you can surround the keywords with double quotes &amp;ldquo;&amp;ldquo;program moon&amp;rdquo;&amp;rdquo;, powerful isn&amp;rsquo;t it?&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Querying Netcraft&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The &lt;a class=&#34;link&#34; href=&#34;https://searchdns.netcraft.com/?restriction=site&amp;#43;contains&amp;amp;host=nist.gov&amp;amp;position=limited&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Netcraft Web Application&lt;/a&gt; contains historical server fingerprints, which you can use to check the OS versions or map network blocks of a company&lt;/p&gt;
&lt;p&gt;The link above shows the result of all recorded NIST government sites with their site, netblock, OS.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-01_10-47-07_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Shodan&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://help.shodan.io/the-basics/what-is-shodan&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Shodan&lt;/a&gt; is a powerful search engine for gathering infomration on all devices connected to Internet.
Use search query syntax(city, country, http.title net, org, port, etc.) to search for the devices information wihthin the whole Internet. Some entries even may list corresponding known vulnerabilities.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-01_14-50-38_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Differences with Google?&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Google queries the resources on World Wide Web, but it is only a tiny fraction of Internet, Shodan&amp;rsquo;s goal is to provide a complete picture of the Internet.&lt;/li&gt;
&lt;li&gt;Shodan explicityly requires search query syntax.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;LinkedIn&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;LinkedIn has a lot of personal profile, it is always a good begining for attack like social engineering to dig deeper into an employee and an organisation. The LinkedIn Premium would help to look for people and roles without notifying them.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Domain WHOIS&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://who.is/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;WHOIS&lt;/a&gt; allows you to uncover the details information behind a domain. Typically, it contains:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Administrative contact details&lt;/li&gt;
&lt;li&gt;Mailing addresses for office locations&lt;/li&gt;
&lt;li&gt;Details of authoritative name servers for each domain&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;Automated Email Enumeration&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The &lt;code&gt;TheHarvester&lt;/code&gt; tool is used for gathering information of emails. sub-domains, hosts, employee names, open ports, and banners from different public sources like search engines, PGP key servers, and SHODAN computer database.&lt;/p&gt;
&lt;p&gt;example 1
Search email addresses from domain kali.org with results of 200 and using Bing as data source.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;theharvester -d kali.org -l &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; -b bing
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;example 2&lt;/p&gt;
&lt;p&gt;Search email addresses from domain nist.gov with results of 50 and using google as data source, finally  saved the resources in myresults.html&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol start=&#34;7&#34;&gt;
&lt;li&gt;DNS Querying&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;http://etutorials.org/Networking/network&amp;#43;security&amp;#43;assessment/Chapter&amp;#43;3.&amp;#43;Internet&amp;#43;Host&amp;#43;and&amp;#43;Network&amp;#43;Enumeration/3.3&amp;#43;DNS&amp;#43;Querying/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;http://etutorials.org/Networking/network+security+assessment/Chapter+3.+Internet+Host+and+Network+Enumeration/3.3+DNS+Querying/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;What information we could retrieve from DNS Querying?
: Including:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; -   Ahutoritative DNS server information from name server (NS) records
 -   Domain and subdomain information
 -   Hostname information from A, PTR, and CNAME records
 -   Public points of presence taht list mail exchanger (MX) records

 In some cases, poorly configured DNS servers also allow you to enumerate:

 -   Operating-system and platform information of hosts from the host information (HINFO) record
 -   Names and IP addresses of internal or nonpublic hosts and networks
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;Why it is a passive recon?
: There is no active scanning or probing of the target networkds, you just probe and query the information with authroitative DNS servers (for those doamins or network blocks taht are often run by ISPs). Meanwhile, most name servers are not aware of these potential sweeps, because they looks like normal DNS traffic.&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Forward DNS Querying&lt;/p&gt;
&lt;p&gt;Legitimate forward query:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;An end user accesses web site&lt;/li&gt;
&lt;li&gt;During the recipt of email when SMTP mail exchanger ifnormation is requested about the relevant domain&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Attacker:
Issue forward DNS queries to identify mail servers and other obvious Internet-based systems&lt;/p&gt;
&lt;p&gt;Tools:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The Sam Spade Windows client (available from &lt;a class=&#34;link&#34; href=&#34;http://www.samspade.org&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;http://www.samspade.org&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;The nslookup client found within most operating systems&lt;/li&gt;
&lt;li&gt;The host client found within Unix environments&lt;/li&gt;
&lt;li&gt;The dig client found within Unix environments&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;DNS Zone transfer Techniques&lt;/p&gt;
&lt;p&gt;DNS zone
: A DNS zone file contains all the naming infomration that the name server stores regarding a specific DNS domain, often including details of nonpublic internal networks and other userful information you can use to build an accurate map of the target infrastructure.&lt;/p&gt;
&lt;p&gt;Why we need DNS Zone transfer?
: In most organisations, they use multiple name server to implement laod balancing and fault tolerance.
The main name server is known as the primary name server and all subsequent name servers are secondary name servers.
Either a primary or secondary name server can be queried for name resolution, THUS it is important that each name server have current DNS zone information.
To ensure this, a secondary name server will regularly requests a complete listing of the computers it is responsible for from the primary.&lt;/p&gt;
&lt;p&gt;Tools used to request DNS zone transfer information include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The Sam Spade Windows client (available from &lt;a class=&#34;link&#34; href=&#34;http://www.samspade.org&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;http://www.samspade.org&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;The nslookup client found within most operating systems&lt;/li&gt;
&lt;li&gt;The host client found within Unix-based environments&lt;/li&gt;
&lt;li&gt;The dig client found within Unix-based environments&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Reverse DNS Sweeping&lt;/p&gt;
&lt;p&gt;You may notice in previous techniques, they require domain name as parameter, but in this case, we do the opposite thing agains name resolution, we called reverse DNS, it can gather details of hosts that may be protected or filtered but still have DNS hostnames assigned to them. It is also able to identify hosts and potential weaknesses within Internet-based points of presence because it reveals hosts and networks that may not be revealed during DNS zone transfer queries.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Countermeasures&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Disable directory indexing on Web servers&lt;/li&gt;
&lt;li&gt;Use “robots.txt” to prevent indexing of certain content by search engines
but do NOT rely on it to protect sensitive data&lt;/li&gt;
&lt;li&gt;Use generic details in WHOIS data (or privacy-protect it)&lt;/li&gt;
&lt;li&gt;Disable DNS zone transfers to untrusted hosts&lt;/li&gt;
&lt;li&gt;Prune DNS zone files from unnecessary information&lt;/li&gt;
&lt;li&gt;Preventing TypoSquatting: you may check if a similar domain is available, if you are Nintendo you may check for alternative domains with small variants (that people may mistype by accident while trying to visit your website).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;active-reconnaissance&#34;&gt;Active reconnaissance&lt;/h4&gt;
&lt;p&gt;Compare to the passive recoonaissance, ACTIVE means actively interact with target services, network and hosts.&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Active Reconnaissance Tools&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://nmap.org/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Nmap&lt;/a&gt; (&amp;ldquo;Network mapper&amp;rdquo;) is the most used tools to perform Internet network scans, is a free and open source utility for network discovery and security auditing.&lt;/p&gt;
&lt;p&gt;Other commonly used tools include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Nessus&lt;/li&gt;
&lt;li&gt;Rapid7 Nexpose&lt;/li&gt;
&lt;li&gt;QualysGuard&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You always need to use both free and commerical tools to assess the network because the attackers will do the same!&lt;/p&gt;
&lt;p&gt;Some types of nmap scans&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;TCP scanning with connection (-sT, the default)&lt;/li&gt;
&lt;li&gt;TCP scanning with SYN packets (-sS)&lt;/li&gt;
&lt;li&gt;TCP scanning through FIN packets (-sF)&lt;/li&gt;
&lt;li&gt;TCP scanning empty (-sN)&lt;/li&gt;
&lt;li&gt;TCP scanning Xmas Tree (FIN + PUSH + URG, -sX)&lt;/li&gt;
&lt;li&gt;TCP scanning through ACK packets (-sA)&lt;/li&gt;
&lt;li&gt;TCP canning with Window Size (-sW)&lt;/li&gt;
&lt;li&gt;TCP scanning through R&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Host Scanning&lt;/p&gt;
&lt;p&gt;Aim
: To confirm if a target IP is reachable/active through Internet&lt;/p&gt;
&lt;p&gt;Automated execution of a series of ping commands to determine which systems are active&lt;/p&gt;
&lt;p&gt;Known Techniques&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Ping sweep&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ICMP sweep&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Normally, the &amp;ldquo;ping&amp;rdquo; command is used to send ICMP ECHO_REQUEST packet to expect ICMP ECHO_REPLY
However, it takes too much time in a large-scale networkds because of waiting for the replay sequencly&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Thus, wecould use fping to sends &amp;ldquo;blocks of ping&amp;rdquo;   at the same time to fix this problem&lt;/p&gt;
&lt;p&gt;Defense against ping and fping scans
: Block all ICMP traffic&lt;/p&gt;
&lt;p&gt;Counter-dfense
: -   scan ports at the transfer layer (TCP/UDP), e.g., through nmap or hping3 to send TCP ACK, you can see an example in Idle scanning later.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Port Scanning&lt;/p&gt;
&lt;p&gt;Aim
: Try to connect to TCP and UDP ports of the target system to determine which network services are active (or LISTENING)&lt;/p&gt;
&lt;p&gt;It is important to know the active ports which can by exploited to attack&lt;/p&gt;
&lt;p&gt;UDP Portscan
: Send a zero-length UDP packet to each port to determine which UDP services are available, if an ICMP error message &amp;ldquo;port unreachable&amp;rdquo; is received, it assumed that this service is unavailable&lt;/p&gt;
&lt;p&gt;TCP Portscan
: Try to establish a TCP handshake to all the 65535 ports of the victim host to determine TCP services are available or not
-   Advantage: no need to be root
-   Disadvantage: very noisy&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;TCP FIN Scan&lt;/p&gt;
&lt;p&gt;The attacker sends a FIN-makred (to close TCP connection) packet to victim host&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;If the port is closed a RST pakcet is sent back&lt;/li&gt;
&lt;li&gt;If the port is open the FIN pakcet is ignored (timeout)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Idle Scanning&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.icterra.com/what-is-idle-scan/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.icterra.com/what-is-idle-scan/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;How to understand the word &amp;ldquo;idle&amp;rdquo;?
: &amp;ldquo;Idle&amp;rdquo; is the requirement of the zombie computer, it requires the zombie computer have low network traffic (or better it has almost no traffic). Thus it usually happens overnight.&lt;/p&gt;
&lt;p&gt;So why we need the zombie computers do not have any other traffic? The reason is directly point to the mechanism of idle scanning. Basically, idle scanning is aim to use zombie computers to &amp;ldquo;relay&amp;rdquo; the scan without exposing attackers, and get the status of service ports.&lt;/p&gt;
&lt;p&gt;Before we elborate the mechnisms of idle scanning, let&amp;rsquo;s briefly recap the knowledge about the response of SYN segments
TCP SYN Scanning:
AKA &amp;ldquo;half-open&amp;rdquo; scanning&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;If a SYN/ACK segment is sent to a host it responds with RST segment (because there is no correspoonding session which started with a SYN earlier to SYN/ACK)&lt;/li&gt;
&lt;li&gt;If a SYN segment is sent to a host it responds with a RST if the port closed&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-05_16-13-15_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;If a SYN segment is sent to a host it responds with a RST if the port closed,&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-05_16-13-25_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;If a SYN segment is sent to a host it doesn&amp;rsquo;t give a response if the port filtered.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-05_16-13-30_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;p&gt;Now let&amp;rsquo;s understand the mechanism details with three scanning examples:&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Idle Scan (Victim Port Open)&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;The attacker sends a SYN/ACK segment to the Zombie computer&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Zombie computer responses with RST segment and its IP ID is incremented by &amp;ldquo;one&amp;rdquo;&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Since attackers get the initial IP ID value of Zombie computer, they will then sends a spoofed SYN segment with Zombie computer&amp;rsquo;s IP address to the Victim&amp;rsquo;s computer&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-05_16-16-48_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Since the target port is open, the victim computer will response a SYN/ACK segment to Zombie computer.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-05_16-19-04_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;However, the zombie computer did not establish a session with Victim computer, so when it receive the SYN/ACK segment, it will respond with a RST segment to it, and meanwhile, increases its IP ID by &amp;ldquo;one&amp;rdquo; to 6,163&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-05_16-21-12_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The attackers want to check the current IP ID, thus they send another SYN/ACK segment to The Zombie computer&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-05_16-22-07_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The Zombie computer responds with a RST segment and increases its IP ID by &amp;ldquo;one&amp;rdquo; to 6,164. The attackers check the IP ID is increased by &amp;ldquo;two&amp;rdquo; which could confirm that the victim computer is OPEN.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Based on this, we can also get the reason why we require the victim computer to be &amp;ldquo;idle&amp;rdquo;, otherwise, the increment could be uncertain.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Idle Scan (Victim Port Closed)&lt;/p&gt;
&lt;p&gt;So, what if the port is closed?
This time, the spoofed SYN segment will get the response of RST, which avoid the Zombie computer to interact with Victim computer, and the IP ID did not increase, thus finally we will get the IP ID only increase by &amp;ldquo;one&amp;rdquo;, which indicate the port is closed.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-05_16-28-35_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-05_16-28-39_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-05_16-28-43_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-05_16-28-47_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Idle Scan (Victim Port Fillterd)&lt;/p&gt;
&lt;p&gt;If there is a firewall filter the spoofed SYN segment, the Victim computer will not send anything to Zombie computer, which result in the same IP ID as Port closed case.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-05_16-31-04_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-05_16-30-15_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-05_16-30-40_screenshot.png&#34; width=&#34;400px&#34;/&gt;
&lt;/figure&gt;

&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;OS Fingerprinting&lt;/p&gt;
&lt;p&gt;Aim
: To determine the operating system of a host: Which OS? Which Version?&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo nmap -O localhost
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Service Enumeration/Banner Grabbing&lt;/p&gt;
&lt;p&gt;By grabbing the headers of exposed services, nmap (option -sV) can try to infer the exact service version&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Nmap Scripting Engine&lt;/p&gt;
&lt;p&gt;Nmap provide a series of scripts for checking the vulnerabilities based on open services of victim host&lt;/p&gt;
&lt;p&gt;Scripts can be found in &lt;em&gt;usr/share/nmap/scripts&lt;/em&gt;&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://example.com/ox-hugo/2022-03-06_11-32-26_screenshot.png&#34; width=&#34;700px&#34;/&gt;
&lt;/figure&gt;

&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Mitnick-Shimomura attack&lt;/p&gt;
&lt;p&gt;IP spoofing attack&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Countermeasure:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Block scanning (e.g., ICMP)&lt;/li&gt;
&lt;li&gt;Check open ports and configuration, to make sure that only appropriate services are exposed.&lt;/li&gt;
&lt;li&gt;Monitor network activity (e.g., Intrusion Detection System, SIEM)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</description>
        </item>
        
    </channel>
</rss>
