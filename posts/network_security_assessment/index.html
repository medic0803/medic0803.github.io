<!DOCTYPE html>
<html lang="en-uk" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content=''><title>Network Security Assessment</title>

<link rel='canonical' href='https://ginkgo.org.cn/posts/network_security_assessment/'>

<link rel="stylesheet" href="/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css"><meta property='og:title' content='Network Security Assessment'>
<meta property='og:description' content=''>
<meta property='og:url' content='https://ginkgo.org.cn/posts/network_security_assessment/'>
<meta property='og:site_name' content='Under The Ginkgo'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' /><meta property='article:tag' content='reconnaissance' /><meta property='article:tag' content='OSINT' /><meta property='article:tag' content='hacker' /><meta property='article:tag' content='security' /><meta property='article:published_time' content='2022-02-28T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2022-03-19T17:25:38&#43;00:00'/>
<meta name="twitter:title" content="Network Security Assessment">
<meta name="twitter:description" content="">
    <link rel="shortcut icon" href="/img/favicon.ico" />

<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZKEXSTS2N4"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-ZKEXSTS2N4', { 'anonymize_ip': false });
}
</script>

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/Ginkgo_hu5438825b9b6d1014226d20d231e650c2_69187_300x0_resize_q75_box.JPG" width="300"
                            height="237" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üßê</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Under The Ginkgo</a></h1>
            <h2 class="site-description">BOYS FIGHT FOR YOUR LIBERTY</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/medic0803'
                        target="_blank"
                        title="A_GitHub"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='mailto:medicwrf@gmail.com'
                        target="_blank"
                        title="B_E-mail"
                    >
                        
                        
                            <?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1647773061437" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2742" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M937.593333 257.073333A148.353333 148.353333 0 0 0 832 213.333333H384v-42.666666h85.333333a85.333333 85.333333 0 0 0 0-170.666667H362.666667a21.333333 21.333333 0 0 0-21.333334 21.333333v192H212.26A53.426667 53.426667 0 0 0 160 170.666667h-64a53.393333 53.393333 0 0 0-53.333333 53.333333v533.333333a53.393333 53.393333 0 0 0 53.333333 53.333334h64a53.426667 53.426667 0 0 0 52.26-42.666667H384v192a21.333333 21.333333 0 0 0 21.333333 21.333333h170.666667a21.333333 21.333333 0 0 0 21.333333-21.333333v-192h362.666667a21.333333 21.333333 0 0 0 21.333333-21.333333V362.666667a148.353333 148.353333 0 0 0-43.74-105.593334zM512 85.333333a42.713333 42.713333 0 0 1-42.666667 42.666667H384V42.666667h85.333333a42.713333 42.713333 0 0 1 42.666667 42.666666zM170.666667 757.333333a10.666667 10.666667 0 0 1-10.666667 10.666667h-64a10.666667 10.666667 0 0 1-10.666667-10.666667V224a10.666667 10.666667 0 0 1 10.666667-10.666667h64a10.666667 10.666667 0 0 1 10.666667 10.666667z m384 181.333334H426.666667v-170.666667h128z m384-213.333334H213.333333V256h128v149.333333a21.333333 21.333333 0 0 0 21.333334 21.333334h85.333333a21.333333 21.333333 0 0 0 0-42.666667h-64V256h448c58.813333 0 106.666667 47.853333 106.666667 106.666667z" fill="#bababa" p-id="2743"></path></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/course_notes/" >
                course_notes
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/posts/network_security_assessment/">Network Security Assessment</a>
        </h2>
    
        
    </div>

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 28, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    11 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>
</header>

    <section class="article-content">
    
    
    <h2 id="network-security-assessment">Network Security Assessment</h2>
<h3 id="phase-1-reconnaissance">Phase 1: Reconnaissance</h3>
<p>The initial phase of network security assessment is reconnaissance, in my understanding, this phase is used to gather the information of the target, including hosts, networks, users, services, etc. It is an essential preparation mission before you can really do something to the target.</p>
<p>And the recoonaissance could be separated to passive or active.</p>
<h4 id="passive-reconnaissance">Passive reconnaissance</h4>
<p>In this case, &ldquo;passive&rdquo; means you do not directly interact or engage with target system. More specifically, you do not send any type of request to the target, thus the targets have no way of acknowledgement what you are doing.</p>
<p>You should use all the tools to gather more information as possible</p>
<p>Querying Search Engines and Websites
There are some typical data you can gather by querying search engines and wbsites</p>
<ul>
<li>Physical address of office locations</li>
<li>Contact details, including email addresses and telephone numbers</li>
<li>Details of internal email systems and routing</li>
<li>DNS layout and naming conventions</li>
<li>Files residing on publicly accessible servers</li>
</ul>
<p>Here are some powerful tools we can use</p>
<!-- raw HTML omitted -->
<ul>
<li>
<ol>
<li>Google Advanced Search</li>
</ol>
<p>It is very common for us to complain that Google returns some irrelevant results, but actually Google provides some powerful tools to enhance the search, it is the &ldquo;Goolge Advanced search&rdquo;, we can use its syntax to refine our search rules.</p>
<p>For example, &ldquo;inurl:program&rdquo; results in all the websites or resources whose url or cotent contains the keyword &ldquo;program&rdquo;, you can even use &ldquo;allinurl:program&rdquo; to query all the url which contains &ldquo;program&rdquo;.</p>
<p>Another common example is, when you search &ldquo;program moon&rdquo;, the result will probabaly give you a lot of results with &ldquo;program&rdquo; while excluding the keyword &ldquo;moon&rdquo; because obviously there is less result contains moon. However, if you want to search the whole word which contains both &ldquo;program moon&rdquo;, you can surround the keywords with double quotes &ldquo;&ldquo;program moon&rdquo;&rdquo;, powerful isn&rsquo;t it?</p>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<ol start="2">
<li>Querying Netcraft</li>
</ol>
<p>The <a class="link" href="https://searchdns.netcraft.com/?restriction=site&#43;contains&amp;host=nist.gov&amp;position=limited"  target="_blank" rel="noopener"
    >Netcraft Web Application</a> contains historical server fingerprints, which you can use to check the OS versions or map network blocks of a company</p>
<p>The link above shows the result of all recorded NIST government sites with their site, netblock, OS.</p>
<figure><img src="/ox-hugo/2022-03-01_10-47-07_screenshot.png" width="700px"/>
</figure>

</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<ol start="3">
<li>Shodan</li>
</ol>
<p><a class="link" href="https://help.shodan.io/the-basics/what-is-shodan"  target="_blank" rel="noopener"
    >Shodan</a> is a powerful search engine for gathering infomration on all devices connected to Internet.
Use search query syntax(city, country, http.title net, org, port, etc.) to search for the devices information wihthin the whole Internet. Some entries even may list corresponding known vulnerabilities.</p>
<figure><img src="/ox-hugo/2022-03-01_14-50-38_screenshot.png" width="700px"/>
</figure>

<!-- raw HTML omitted -->
<ul>
<li>
<p>Differences with Google?</p>
<ol>
<li>Google queries the resources on World Wide Web, but it is only a tiny fraction of Internet, Shodan&rsquo;s goal is to provide a complete picture of the Internet.</li>
<li>Shodan explicityly requires search query syntax.</li>
</ol>
</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<ol start="4">
<li>LinkedIn</li>
</ol>
<p>LinkedIn has a lot of personal profile, it is always a good begining for attack like social engineering to dig deeper into an employee and an organisation. The LinkedIn Premium would help to look for people and roles without notifying them.</p>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<ol start="5">
<li>Domain WHOIS</li>
</ol>
<p><a class="link" href="https://who.is/"  target="_blank" rel="noopener"
    >WHOIS</a> allows you to uncover the details information behind a domain. Typically, it contains:</p>
<ul>
<li>Administrative contact details</li>
<li>Mailing addresses for office locations</li>
<li>Details of authoritative name servers for each domain</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<ol start="6">
<li>Automated Email Enumeration</li>
</ol>
<p>The <code>TheHarvester</code> tool is used for gathering information of emails. sub-domains, hosts, employee names, open ports, and banners from different public sources like search engines, PGP key servers, and SHODAN computer database.</p>
<p>example 1
Search email addresses from domain kali.org with results of 200 and using Bing as data source.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">theharvester -d kali.org -l <span class="m">200</span> -b bing
</span></span></code></pre></div><p>example 2</p>
<p>Search email addresses from domain nist.gov with results of 50 and using google as data source, finally  saved the resources in myresults.html</p>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<ol start="7">
<li>DNS Querying</li>
</ol>
<p><a class="link" href="http://etutorials.org/Networking/network&#43;security&#43;assessment/Chapter&#43;3.&#43;Internet&#43;Host&#43;and&#43;Network&#43;Enumeration/3.3&#43;DNS&#43;Querying/"  target="_blank" rel="noopener"
    >http://etutorials.org/Networking/network+security+assessment/Chapter+3.+Internet+Host+and+Network+Enumeration/3.3+DNS+Querying/</a></p>
<p>What information we could retrieve from DNS Querying?
: Including:</p>
<pre><code> -   Ahutoritative DNS server information from name server (NS) records
 -   Domain and subdomain information
 -   Hostname information from A, PTR, and CNAME records
 -   Public points of presence taht list mail exchanger (MX) records

 In some cases, poorly configured DNS servers also allow you to enumerate:

 -   Operating-system and platform information of hosts from the host information (HINFO) record
 -   Names and IP addresses of internal or nonpublic hosts and networks
</code></pre>
<!-- raw HTML omitted -->
<p>Why it is a passive recon?
: There is no active scanning or probing of the target networkds, you just probe and query the information with authroitative DNS servers (for those doamins or network blocks taht are often run by ISPs). Meanwhile, most name servers are not aware of these potential sweeps, because they looks like normal DNS traffic.</p>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Forward DNS Querying</p>
<p>Legitimate forward query:</p>
<ol>
<li>An end user accesses web site</li>
<li>During the recipt of email when SMTP mail exchanger ifnormation is requested about the relevant domain</li>
</ol>
<p>Attacker:
Issue forward DNS queries to identify mail servers and other obvious Internet-based systems</p>
<p>Tools:</p>
<ul>
<li>The Sam Spade Windows client (available from <a class="link" href="http://www.samspade.org"  target="_blank" rel="noopener"
    >http://www.samspade.org</a>)</li>
<li>The nslookup client found within most operating systems</li>
<li>The host client found within Unix environments</li>
<li>The dig client found within Unix environments</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>DNS Zone transfer Techniques</p>
<p>DNS zone
: A DNS zone file contains all the naming infomration that the name server stores regarding a specific DNS domain, often including details of nonpublic internal networks and other userful information you can use to build an accurate map of the target infrastructure.</p>
<p>Why we need DNS Zone transfer?
: In most organisations, they use multiple name server to implement laod balancing and fault tolerance.
The main name server is known as the primary name server and all subsequent name servers are secondary name servers.
Either a primary or secondary name server can be queried for name resolution, THUS it is important that each name server have current DNS zone information.
To ensure this, a secondary name server will regularly requests a complete listing of the computers it is responsible for from the primary.</p>
<p>Tools used to request DNS zone transfer information include:</p>
<ul>
<li>The Sam Spade Windows client (available from <a class="link" href="http://www.samspade.org"  target="_blank" rel="noopener"
    >http://www.samspade.org</a>)</li>
<li>The nslookup client found within most operating systems</li>
<li>The host client found within Unix-based environments</li>
<li>The dig client found within Unix-based environments</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Reverse DNS Sweeping</p>
<p>You may notice in previous techniques, they require domain name as parameter, but in this case, we do the opposite thing agains name resolution, we called reverse DNS, it can gather details of hosts that may be protected or filtered but still have DNS hostnames assigned to them. It is also able to identify hosts and potential weaknesses within Internet-based points of presence because it reveals hosts and networks that may not be revealed during DNS zone transfer queries.</p>
</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Countermeasures</p>
<ul>
<li>Disable directory indexing on Web servers</li>
<li>Use ‚Äúrobots.txt‚Äù to prevent indexing of certain content by search engines
but do NOT rely on it to protect sensitive data</li>
<li>Use generic details in WHOIS data (or privacy-protect it)</li>
<li>Disable DNS zone transfers to untrusted hosts</li>
<li>Prune DNS zone files from unnecessary information</li>
<li>Preventing TypoSquatting: you may check if a similar domain is available, if you are Nintendo you may check for alternative domains with small variants (that people may mistype by accident while trying to visit your website).</li>
</ul>
</li>
</ul>
<h4 id="active-reconnaissance">Active reconnaissance</h4>
<p>Compare to the passive recoonaissance, ACTIVE means actively interact with target services, network and hosts.</p>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Active Reconnaissance Tools</p>
<p><a class="link" href="https://nmap.org/"  target="_blank" rel="noopener"
    >Nmap</a> (&ldquo;Network mapper&rdquo;) is the most used tools to perform Internet network scans, is a free and open source utility for network discovery and security auditing.</p>
<p>Other commonly used tools include:</p>
<ul>
<li>Nessus</li>
<li>Rapid7 Nexpose</li>
<li>QualysGuard</li>
</ul>
<p>You always need to use both free and commerical tools to assess the network because the attackers will do the same!</p>
<p>Some types of nmap scans</p>
<ul>
<li>TCP scanning with connection (-sT, the default)</li>
<li>TCP scanning with SYN packets (-sS)</li>
<li>TCP scanning through FIN packets (-sF)</li>
<li>TCP scanning empty (-sN)</li>
<li>TCP scanning Xmas Tree (FIN + PUSH + URG, -sX)</li>
<li>TCP scanning through ACK packets (-sA)</li>
<li>TCP canning with Window Size (-sW)</li>
<li>TCP scanning through R</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Host Scanning</p>
<p>Aim
: To confirm if a target IP is reachable/active through Internet</p>
<p>Automated execution of a series of ping commands to determine which systems are active</p>
<p>Known Techniques</p>
<ul>
<li>
<p>Ping sweep</p>
</li>
<li>
<p>ICMP sweep</p>
</li>
<li>
<p>Normally, the &ldquo;ping&rdquo; command is used to send ICMP ECHO_REQUEST packet to expect ICMP ECHO_REPLY
However, it takes too much time in a large-scale networkds because of waiting for the replay sequencly</p>
</li>
</ul>
<p>Thus, wecould use fping to sends &ldquo;blocks of ping&rdquo;   at the same time to fix this problem</p>
<p>Defense against ping and fping scans
: Block all ICMP traffic</p>
<p>Counter-dfense
: -   scan ports at the transfer layer (TCP/UDP), e.g., through nmap or hping3 to send TCP ACK, you can see an example in Idle scanning later.</p>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Port Scanning</p>
<p>Aim
: Try to connect to TCP and UDP ports of the target system to determine which network services are active (or LISTENING)</p>
<p>It is important to know the active ports which can by exploited to attack</p>
<p>UDP Portscan
: Send a zero-length UDP packet to each port to determine which UDP services are available, if an ICMP error message &ldquo;port unreachable&rdquo; is received, it assumed that this service is unavailable</p>
<p>TCP Portscan
: Try to establish a TCP handshake to all the 65535 ports of the victim host to determine TCP services are available or not
-   Advantage: no need to be root
-   Disadvantage: very noisy</p>
<!-- raw HTML omitted -->
<ul>
<li>
<p>TCP FIN Scan</p>
<p>The attacker sends a FIN-makred (to close TCP connection) packet to victim host</p>
<ul>
<li>If the port is closed a RST pakcet is sent back</li>
<li>If the port is open the FIN pakcet is ignored (timeout)</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Idle Scanning</p>
<p><a class="link" href="https://www.icterra.com/what-is-idle-scan/"  target="_blank" rel="noopener"
    >https://www.icterra.com/what-is-idle-scan/</a></p>
<p>How to understand the word &ldquo;idle&rdquo;?
: &ldquo;Idle&rdquo; is the requirement of the zombie computer, it requires the zombie computer have low network traffic (or better it has almost no traffic). Thus it usually happens overnight.</p>
<p>So why we need the zombie computers do not have any other traffic? The reason is directly point to the mechanism of idle scanning. Basically, idle scanning is aim to use zombie computers to &ldquo;relay&rdquo; the scan without exposing attackers, and get the status of service ports.</p>
<p>Before we elborate the mechnisms of idle scanning, let&rsquo;s briefly recap the knowledge about the response of SYN segments
TCP SYN Scanning:
AKA &ldquo;half-open&rdquo; scanning</p>
<ul>
<li>If a SYN/ACK segment is sent to a host it responds with RST segment (because there is no correspoonding session which started with a SYN earlier to SYN/ACK)</li>
<li>If a SYN segment is sent to a host it responds with a RST if the port closed</li>
</ul>
<figure><img src="/ox-hugo/2022-03-05_16-13-15_screenshot.png" width="400px"/>
</figure>

<ul>
<li>
<p>If a SYN segment is sent to a host it responds with a RST if the port closed,</p>
<figure><img src="/ox-hugo/2022-03-05_16-13-25_screenshot.png" width="400px"/>
</figure>

</li>
<li>
<p>If a SYN segment is sent to a host it doesn&rsquo;t give a response if the port filtered.</p>
</li>
</ul>
<figure><img src="/ox-hugo/2022-03-05_16-13-30_screenshot.png" width="400px"/>
</figure>

<p>Now let&rsquo;s understand the mechanism details with three scanning examples:</p>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Idle Scan (Victim Port Open)</p>
<ol>
<li>
<p>The attacker sends a SYN/ACK segment to the Zombie computer</p>
</li>
<li>
<p>Zombie computer responses with RST segment and its IP ID is incremented by &ldquo;one&rdquo;</p>
<!-- raw HTML omitted -->
</li>
<li>
<p>Since attackers get the initial IP ID value of Zombie computer, they will then sends a spoofed SYN segment with Zombie computer&rsquo;s IP address to the Victim&rsquo;s computer</p>
<figure><img src="/ox-hugo/2022-03-05_16-16-48_screenshot.png" width="400px"/>
</figure>

</li>
<li>
<p>Since the target port is open, the victim computer will response a SYN/ACK segment to Zombie computer.</p>
<figure><img src="/ox-hugo/2022-03-05_16-19-04_screenshot.png" width="400px"/>
</figure>

</li>
<li>
<p>However, the zombie computer did not establish a session with Victim computer, so when it receive the SYN/ACK segment, it will respond with a RST segment to it, and meanwhile, increases its IP ID by &ldquo;one&rdquo; to 6,163</p>
<figure><img src="/ox-hugo/2022-03-05_16-21-12_screenshot.png" width="400px"/>
</figure>

</li>
<li>
<p>The attackers want to check the current IP ID, thus they send another SYN/ACK segment to The Zombie computer</p>
<figure><img src="/ox-hugo/2022-03-05_16-22-07_screenshot.png" width="400px"/>
</figure>

</li>
<li>
<p>The Zombie computer responds with a RST segment and increases its IP ID by &ldquo;one&rdquo; to 6,164. The attackers check the IP ID is increased by &ldquo;two&rdquo; which could confirm that the victim computer is OPEN.</p>
</li>
</ol>
<p>Based on this, we can also get the reason why we require the victim computer to be &ldquo;idle&rdquo;, otherwise, the increment could be uncertain.</p>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Idle Scan (Victim Port Closed)</p>
<p>So, what if the port is closed?
This time, the spoofed SYN segment will get the response of RST, which avoid the Zombie computer to interact with Victim computer, and the IP ID did not increase, thus finally we will get the IP ID only increase by &ldquo;one&rdquo;, which indicate the port is closed.</p>
<figure><img src="/ox-hugo/2022-03-05_16-28-35_screenshot.png" width="400px"/>
</figure>

<figure><img src="/ox-hugo/2022-03-05_16-28-39_screenshot.png" width="400px"/>
</figure>

<figure><img src="/ox-hugo/2022-03-05_16-28-43_screenshot.png" width="400px"/>
</figure>

<figure><img src="/ox-hugo/2022-03-05_16-28-47_screenshot.png" width="400px"/>
</figure>

</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Idle Scan (Victim Port Fillterd)</p>
<p>If there is a firewall filter the spoofed SYN segment, the Victim computer will not send anything to Zombie computer, which result in the same IP ID as Port closed case.</p>
<figure><img src="/ox-hugo/2022-03-05_16-31-04_screenshot.png" width="400px"/>
</figure>

<figure><img src="/ox-hugo/2022-03-05_16-30-15_screenshot.png" width="400px"/>
</figure>

<figure><img src="/ox-hugo/2022-03-05_16-30-40_screenshot.png" width="400px"/>
</figure>

</li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>OS Fingerprinting</p>
<p>Aim
: To determine the operating system of a host: Which OS? Which Version?</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo nmap -O localhost
</span></span></code></pre></div></li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Service Enumeration/Banner Grabbing</p>
<p>By grabbing the headers of exposed services, nmap (option -sV) can try to infer the exact service version</p>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Nmap Scripting Engine</p>
<p>Nmap provide a series of scripts for checking the vulnerabilities based on open services of victim host</p>
<p>Scripts can be found in <em>usr/share/nmap/scripts</em></p>
<figure><img src="/ox-hugo/2022-03-06_11-32-26_screenshot.png" width="700px"/>
</figure>

</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Mitnick-Shimomura attack</p>
<p>IP spoofing attack</p>
</li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>
<p>Countermeasure:</p>
<ul>
<li>Block scanning (e.g., ICMP)</li>
<li>Check open ports and configuration, to make sure that only appropriate services are exposed.</li>
<li>Monitor network activity (e.g., Intrusion Detection System, SIEM)</li>
</ul>
</li>
</ul>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/reconnaissance/">reconnaissance</a>
        
            <a href="/tags/osint/">OSINT</a>
        
            <a href="/tags/hacker/">hacker</a>
        
            <a href="/tags/security/">security</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            Last updated on Mar 19, 2022 17:25 UTC
        </span>
    </section></footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"integrity="sha384-vZTG03m&#43;2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    

    

<aside class="related-contents--wrapper">
    <h2 class="section-title">Related contents</h2>
    <div class="related-contents">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/posts/social_engineering/">
        
        

        <div class="article-details">
            <h2 class="article-title">Social Engineering</h2>
        </div>
    </a>
</article>
            
                
<article class="">
    <a href="/posts/cfc_week_2_advanced_malware_and_worldwide_spam_economy/">
        
        

        <div class="article-details">
            <h2 class="article-title">CFC Week 2: Advanced malware and worldwide SPAM</h2>
        </div>
    </a>
</article>
            
                
<article class="">
    <a href="/posts/cfc_week_4_cybercrime_mitigations/">
        
        

        <div class="article-details">
            <h2 class="article-title">CFC Week 4: Cybercrime mitigations</h2>
        </div>
    </a>
</article>
            
                
<article class="">
    <a href="/posts/cfc_week_5_legal_framework/">
        
        

        <div class="article-details">
            <h2 class="article-title">CFC Week 5: Legal Framework</h2>
        </div>
    </a>
</article>
            
                
<article class="">
    <a href="/posts/cfc_week_9_incident_management/">
        
        

        <div class="article-details">
            <h2 class="article-title">CFC Week 9: Incident Management</h2>
        </div>
    </a>
</article>
            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "medicwrf" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy;
        
        2022 Under The Ginkgo
    </section>

    <section class="powerby">
        
            Cogito, ergo sum <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.11.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
    </script>
    <section class="powerby">
      <span id="busuanzi_container_site_pv" style='display:none'>
        Viwe <span id="busuanzi_value_site_pv"></span> times
      </span>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#network-security-assessment">Network Security Assessment</a>
      <ul>
        <li><a href="#phase-1-reconnaissance">Phase 1: Reconnaissance</a>
          <ul>
            <li><a href="#passive-reconnaissance">Passive reconnaissance</a></li>
            <li><a href="#active-reconnaissance">Active reconnaissance</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
    </section>

            
        
    </aside>


        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
